<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Figures | Extraction of tabular data from annual reports with LLMs</title>
  <meta name="description" content="10 Figures | Extraction of tabular data from annual reports with LLMs" />
  <meta name="generator" content="bookdown 0.43.2 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Figures | Extraction of tabular data from annual reports with LLMs" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Figures | Extraction of tabular data from annual reports with LLMs" />
  
  
  

<meta name="author" content="Simon Schäfer" />


<meta name="date" content="2025-09-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tables.html"/>
<link rel="next" href="layout-testing.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/dt-ext-rowgroup-1.13.6/css/rowGroup.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-rowgroup-1.13.6/js/dataTables.rowGroup.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glider-js@1/glider.min.css">
<script src="https://cdn.jsdelivr.net/npm/glider-js@1/glider.min.js"></script> -->


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="report_misc/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/BHT_Logo_horizontal_Anthrazit_transparent.svg"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#objectives"><i class="fa fa-check"></i><b>1.2</b> Objectives</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#introduction-methodology"><i class="fa fa-check"></i><b>1.3</b> Methodology</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#thesis-outline"><i class="fa fa-check"></i><b>1.4</b> Thesis Outline</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#summary"><i class="fa fa-check"></i><b>1.5</b> Summary</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#to-place-in-chapters-above"><i class="fa fa-check"></i><b>1.6</b> To place in chapters above</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#unstrukturierte-daten"><i class="fa fa-check"></i><b>1.7</b> Unstrukturierte Daten</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="introduction.html"><a href="introduction.html#portable-document-format"><i class="fa fa-check"></i><b>1.7.1</b> Portable Document Format</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="literature-review.html"><a href="literature-review.html"><i class="fa fa-check"></i><b>2</b> Literature review</a>
<ul>
<li class="chapter" data-level="2.1" data-path="literature-review.html"><a href="literature-review.html#information-retrieval"><i class="fa fa-check"></i><b>2.1</b> Information extraction / retrieval</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="literature-review.html"><a href="literature-review.html#term-frequency"><i class="fa fa-check"></i><b>2.1.1</b> Term frequency</a></li>
<li class="chapter" data-level="2.1.2" data-path="literature-review.html"><a href="literature-review.html#text-processing"><i class="fa fa-check"></i><b>2.1.2</b> Text processing</a></li>
<li class="chapter" data-level="2.1.3" data-path="literature-review.html"><a href="literature-review.html#regular-expressions"><i class="fa fa-check"></i><b>2.1.3</b> Regular expressions</a></li>
<li class="chapter" data-level="2.1.4" data-path="literature-review.html"><a href="literature-review.html#llm-theory"><i class="fa fa-check"></i><b>2.1.4</b> Large Language Models</a>
<ul>
<li class="chapter" data-level="2.1.4.1" data-path="literature-review.html"><a href="literature-review.html#transformers"><i class="fa fa-check"></i><b>2.1.4.1</b> Transformers</a></li>
<li class="chapter" data-level="2.1.4.2" data-path="literature-review.html"><a href="literature-review.html#encoder"><i class="fa fa-check"></i><b>2.1.4.2</b> Encoder</a></li>
<li class="chapter" data-level="2.1.4.3" data-path="literature-review.html"><a href="literature-review.html#decoder"><i class="fa fa-check"></i><b>2.1.4.3</b> Decoder</a></li>
<li class="chapter" data-level="2.1.4.4" data-path="literature-review.html"><a href="literature-review.html#gpt-generative-pretrained-transformers"><i class="fa fa-check"></i><b>2.1.4.4</b> GPT (Generative Pretrained Transformers)</a></li>
<li class="chapter" data-level="2.1.4.5" data-path="literature-review.html"><a href="literature-review.html#mixture-of-experts"><i class="fa fa-check"></i><b>2.1.4.5</b> Mixture of Experts</a></li>
<li class="chapter" data-level="2.1.4.6" data-path="literature-review.html"><a href="literature-review.html#mixed-modal"><i class="fa fa-check"></i><b>2.1.4.6</b> Mixed modal</a></li>
</ul></li>
<li class="chapter" data-level="2.1.5" data-path="literature-review.html"><a href="literature-review.html#llm-methods"><i class="fa fa-check"></i><b>2.1.5</b> Methods for LLM application</a>
<ul>
<li class="chapter" data-level="2.1.5.1" data-path="literature-review.html"><a href="literature-review.html#few-shot-learning"><i class="fa fa-check"></i><b>2.1.5.1</b> Few-shot Learning</a></li>
<li class="chapter" data-level="2.1.5.2" data-path="literature-review.html"><a href="literature-review.html#rag"><i class="fa fa-check"></i><b>2.1.5.2</b> RAG</a></li>
<li class="chapter" data-level="2.1.5.3" data-path="literature-review.html"><a href="literature-review.html#guided-and-restricted-decoding"><i class="fa fa-check"></i><b>2.1.5.3</b> Guided and restricted decoding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="literature-review.html"><a href="literature-review.html#other-concepts"><i class="fa fa-check"></i><b>2.2</b> Other concepts</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="literature-review.html"><a href="literature-review.html#sample-distribution-visualization-methods"><i class="fa fa-check"></i><b>2.2.1</b> Sample distribution visualization methods</a></li>
<li class="chapter" data-level="2.2.2" data-path="literature-review.html"><a href="literature-review.html#tree-based-machine-learning-algorithms"><i class="fa fa-check"></i><b>2.2.2</b> Tree based machine learning algorithms</a></li>
<li class="chapter" data-level="2.2.3" data-path="literature-review.html"><a href="literature-review.html#shap"><i class="fa fa-check"></i><b>2.2.3</b> Model agnostic explanation models</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="literature-review.html"><a href="literature-review.html#summary-0.5-p"><i class="fa fa-check"></i><b>2.3</b> Summary (0.5 p)</a></li>
<li class="chapter" data-level="2.4" data-path="literature-review.html"><a href="literature-review.html#to-place-in-chapters-above-1"><i class="fa fa-check"></i><b>2.4</b> To place in chapters above</a></li>
<li class="chapter" data-level="2.5" data-path="literature-review.html"><a href="literature-review.html#table-extraction-tasks"><i class="fa fa-check"></i><b>2.5</b> Table extraction tasks</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="literature-review.html"><a href="literature-review.html#difficulties"><i class="fa fa-check"></i><b>2.5.1</b> Difficulties</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="literature-review.html"><a href="literature-review.html#document-extraction-process"><i class="fa fa-check"></i><b>2.6</b> Document Extraction Process</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="literature-review.html"><a href="literature-review.html#document-layout-analysis"><i class="fa fa-check"></i><b>2.6.1</b> Document Layout Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="literature-review.html"><a href="literature-review.html#tools"><i class="fa fa-check"></i><b>2.7</b> Tools</a>
<ul>
<li class="chapter" data-level="2.7.0.1" data-path="literature-review.html"><a href="literature-review.html#vision-grid-transformer"><i class="fa fa-check"></i><b>2.7.0.1</b> Vision Grid Transformer</a></li>
<li class="chapter" data-level="2.7.0.2" data-path="literature-review.html"><a href="literature-review.html#tableformer"><i class="fa fa-check"></i><b>2.7.0.2</b> TableFormer</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="methodology.html"><a href="methodology.html"><i class="fa fa-check"></i><b>3</b> Methodology</a>
<ul>
<li class="chapter" data-level="3.1" data-path="methodology.html"><a href="methodology.html#problem-definition"><i class="fa fa-check"></i><b>3.1</b> Problem Definition</a></li>
<li class="chapter" data-level="3.2" data-path="methodology.html"><a href="methodology.html#research-design-philosophy"><i class="fa fa-check"></i><b>3.2</b> Research Design &amp; Philosophy</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="methodology.html"><a href="methodology.html#research-questions"><i class="fa fa-check"></i><b>3.2.1</b> Research questions</a></li>
<li class="chapter" data-level="3.2.2" data-path="methodology.html"><a href="methodology.html#evaluation-framework"><i class="fa fa-check"></i><b>3.2.2</b> Evaluation framework</a></li>
<li class="chapter" data-level="3.2.3" data-path="methodology.html"><a href="methodology.html#evaluation-research"><i class="fa fa-check"></i><b>3.2.3</b> Evaluation research</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="methodology.html"><a href="methodology.html#evaluation-strategy"><i class="fa fa-check"></i><b>3.3</b> Evaluation Strategy</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="methodology.html"><a href="methodology.html#metrics"><i class="fa fa-check"></i><b>3.3.1</b> Metrics</a></li>
<li class="chapter" data-level="3.3.2" data-path="methodology.html"><a href="methodology.html#benchmarking"><i class="fa fa-check"></i><b>3.3.2</b> Benchmarking</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="methodology.html"><a href="methodology.html#data-strategy"><i class="fa fa-check"></i><b>3.4</b> Data Strategy</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="methodology.html"><a href="methodology.html#sampling-methodology"><i class="fa fa-check"></i><b>3.4.1</b> Sampling methodology</a></li>
<li class="chapter" data-level="3.4.2" data-path="methodology.html"><a href="methodology.html#ground-truth-creation-process"><i class="fa fa-check"></i><b>3.4.2</b> Ground truth creation process</a></li>
<li class="chapter" data-level="3.4.3" data-path="methodology.html"><a href="methodology.html#preprocessing"><i class="fa fa-check"></i><b>3.4.3</b> Preprocessing</a></li>
<li class="chapter" data-level="3.4.4" data-path="methodology.html"><a href="methodology.html#data-splitting"><i class="fa fa-check"></i><b>3.4.4</b> Data splitting</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="methodology.html"><a href="methodology.html#experimental-framework"><i class="fa fa-check"></i><b>3.5</b> Experimental Framework</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="methodology.html"><a href="methodology.html#gpu-benchmark"><i class="fa fa-check"></i><b>3.5.1</b> Hardware normalization</a></li>
<li class="chapter" data-level="3.5.2" data-path="methodology.html"><a href="methodology.html#error-analysis"><i class="fa fa-check"></i><b>3.5.2</b> Error analysis</a></li>
<li class="chapter" data-level="3.5.3" data-path="methodology.html"><a href="methodology.html#baseline-selection-rationale"><i class="fa fa-check"></i><b>3.5.3</b> Baseline selection rationale</a></li>
<li class="chapter" data-level="3.5.4" data-path="methodology.html"><a href="methodology.html#prompt-building"><i class="fa fa-check"></i><b>3.5.4</b> Prompt building</a></li>
<li class="chapter" data-level="3.5.5" data-path="methodology.html"><a href="methodology.html#evaluation-methods"><i class="fa fa-check"></i><b>3.5.5</b> Evaluation methods</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="methodology.html"><a href="methodology.html#ethical-practical-considerations-eher-am-ende-oder-weg"><i class="fa fa-check"></i><b>3.6</b> Ethical &amp; Practical Considerations (eher am Ende oder weg?)</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="methodology.html"><a href="methodology.html#pdf-extraction-limitations"><i class="fa fa-check"></i><b>3.6.1</b> PDF extraction limitations</a></li>
<li class="chapter" data-level="3.6.2" data-path="methodology.html"><a href="methodology.html#computational-constraints"><i class="fa fa-check"></i><b>3.6.2</b> Computational constraints</a></li>
<li class="chapter" data-level="3.6.3" data-path="methodology.html"><a href="methodology.html#generalizability-scope"><i class="fa fa-check"></i><b>3.6.3</b> Generalizability scope</a></li>
<li class="chapter" data-level="3.6.4" data-path="methodology.html"><a href="methodology.html#ethical-considerations"><i class="fa fa-check"></i><b>3.6.4</b> Ethical considerations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="implementation.html"><a href="implementation.html"><i class="fa fa-check"></i><b>4</b> Implementation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="implementation.html"><a href="implementation.html#environments"><i class="fa fa-check"></i><b>4.1</b> Environments</a></li>
<li class="chapter" data-level="4.2" data-path="implementation.html"><a href="implementation.html#evaluation-and-reporting"><i class="fa fa-check"></i><b>4.2</b> Evaluation and Reporting</a></li>
<li class="chapter" data-level="4.3" data-path="implementation.html"><a href="implementation.html#software-packages"><i class="fa fa-check"></i><b>4.3</b> Software Packages</a></li>
<li class="chapter" data-level="4.4" data-path="implementation.html"><a href="implementation.html#speedup-with-vllm-and-batching"><i class="fa fa-check"></i><b>4.4</b> Speedup with vLLM and batching</a></li>
<li class="chapter" data-level="4.5" data-path="implementation.html"><a href="implementation.html#text-extraction"><i class="fa fa-check"></i><b>4.5</b> Text extraction</a></li>
<li class="chapter" data-level="4.6" data-path="implementation.html"><a href="implementation.html#data-processing"><i class="fa fa-check"></i><b>4.6</b> Data processing</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a>
<ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#page-identification-introduction"><i class="fa fa-check"></i><b>5.1</b> Page identification</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="results.html"><a href="results.html#regex-page-identification"><i class="fa fa-check"></i><b>5.1.1</b> Baseline: Regex</a></li>
<li class="chapter" data-level="5.1.2" data-path="results.html"><a href="results.html#toc-understanding"><i class="fa fa-check"></i><b>5.1.2</b> Table of Contents understanding</a>
<ul>
<li class="chapter" data-level="5.1.2.1" data-path="results.html"><a href="results.html#text-based-toc-understanding"><i class="fa fa-check"></i><b>5.1.2.1</b> Details for the approaches</a></li>
<li class="chapter" data-level="5.1.2.2" data-path="results.html"><a href="results.html#results-1"><i class="fa fa-check"></i><b>5.1.2.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="5.1.3" data-path="results.html"><a href="results.html#llm-page-identification"><i class="fa fa-check"></i><b>5.1.3</b> Classification with LLMs</a>
<ul>
<li class="chapter" data-level="5.1.3.1" data-path="results.html"><a href="results.html#binary-classification"><i class="fa fa-check"></i><b>5.1.3.1</b> Binary classification</a></li>
<li class="chapter" data-level="5.1.3.2" data-path="results.html"><a href="results.html#multi-class-classification"><i class="fa fa-check"></i><b>5.1.3.2</b> Multi-class classification</a></li>
</ul></li>
<li class="chapter" data-level="5.1.4" data-path="results.html"><a href="results.html#tf-classifier"><i class="fa fa-check"></i><b>5.1.4</b> Term frequency based classifier</a></li>
<li class="chapter" data-level="5.1.5" data-path="results.html"><a href="results.html#comparison-page-identification"><i class="fa fa-check"></i><b>5.1.5</b> Comparison</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#table-extraction-introduction"><i class="fa fa-check"></i><b>5.2</b> Table extraction</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="results.html"><a href="results.html#baseline-regex"><i class="fa fa-check"></i><b>5.2.1</b> Baseline: Regex</a></li>
<li class="chapter" data-level="5.2.2" data-path="results.html"><a href="results.html#extraction-with-llms-real-tables"><i class="fa fa-check"></i><b>5.2.2</b> Extraction with LLMs</a>
<ul>
<li class="chapter" data-level="5.2.2.1" data-path="results.html"><a href="results.html#real-table-extraction-results"><i class="fa fa-check"></i><b>5.2.2.1</b> Real tables</a></li>
<li class="chapter" data-level="5.2.2.2" data-path="results.html"><a href="results.html#synthetic-table-extraction"><i class="fa fa-check"></i><b>5.2.2.2</b> Synthetic tables</a></li>
<li class="chapter" data-level="5.2.2.3" data-path="results.html"><a href="results.html#real-table-extraction-synth-context"><i class="fa fa-check"></i><b>5.2.2.3</b> Hybrid approach</a></li>
</ul></li>
<li class="chapter" data-level="5.2.3" data-path="results.html"><a href="results.html#comparing-table-extraction-methods"><i class="fa fa-check"></i><b>5.2.3</b> Comparison</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>6</b> Discussion</a>
<ul>
<li class="chapter" data-level="6.1" data-path="discussion.html"><a href="discussion.html#interpretations"><i class="fa fa-check"></i><b>6.1</b> Interpretations</a>
<ul>
<li class="chapter" data-level="6.1.0.1" data-path="discussion.html"><a href="discussion.html#table-extraction"><i class="fa fa-check"></i><b>6.1.0.1</b> Table extraction</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="discussion.html"><a href="discussion.html#limitations"><i class="fa fa-check"></i><b>6.2</b> Limitations</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="discussion.html"><a href="discussion.html#table-extraction-1"><i class="fa fa-check"></i><b>6.2.1</b> table extraction</a>
<ul>
<li class="chapter" data-level="6.2.1.1" data-path="discussion.html"><a href="discussion.html#regex-baseline"><i class="fa fa-check"></i><b>6.2.1.1</b> Regex baseline</a></li>
</ul></li>
<li class="chapter" data-level="6.2.2" data-path="discussion.html"><a href="discussion.html#classification"><i class="fa fa-check"></i><b>6.2.2</b> classification</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="discussion.html"><a href="discussion.html#not-covered"><i class="fa fa-check"></i><b>6.3</b> Not covered</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="discussion.html"><a href="discussion.html#table-detection-extraction"><i class="fa fa-check"></i><b>6.3.1</b> Table detection / extraction</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="discussion.html"><a href="discussion.html#outlook"><i class="fa fa-check"></i><b>6.4</b> Outlook</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="discussion.html"><a href="discussion.html#vision-model"><i class="fa fa-check"></i><b>6.4.1</b> Vision Model</a></li>
<li class="chapter" data-level="6.4.2" data-path="discussion.html"><a href="discussion.html#docling-and-co"><i class="fa fa-check"></i><b>6.4.2</b> Docling and Co</a></li>
<li class="chapter" data-level="6.4.3" data-path="discussion.html"><a href="discussion.html#table-extraction-2"><i class="fa fa-check"></i><b>6.4.3</b> Table extraction</a></li>
<li class="chapter" data-level="6.4.4" data-path="discussion.html"><a href="discussion.html#sophisticated-approaches-for-text-extraction"><i class="fa fa-check"></i><b>6.4.4</b> Sophisticated approaches for text extraction</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="discussion.html"><a href="discussion.html#error-analysis-1"><i class="fa fa-check"></i><b>6.5</b> Error analysis</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="glossary.html"><a href="glossary.html"><i class="fa fa-check"></i>Glossary</a></li>
<li class="chapter" data-level="8" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>8</b> Appendix</a>
<ul>
<li class="chapter" data-level="8.1" data-path="appendix.html"><a href="appendix.html#hitl"><i class="fa fa-check"></i><b>8.1</b> Human in the loop application</a></li>
<li class="chapter" data-level="8.2" data-path="appendix.html"><a href="appendix.html#local-machine"><i class="fa fa-check"></i><b>8.2</b> Local machine</a></li>
<li class="chapter" data-level="8.3" data-path="appendix.html"><a href="appendix.html#benchmarks"><i class="fa fa-check"></i><b>8.3</b> Benchmarks</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="appendix.html"><a href="appendix.html#text-extraction-benchmark"><i class="fa fa-check"></i><b>8.3.1</b> Text extraction</a></li>
<li class="chapter" data-level="8.3.2" data-path="appendix.html"><a href="appendix.html#table-detection-benchmark"><i class="fa fa-check"></i><b>8.3.2</b> Table detection</a>
<ul>
<li class="chapter" data-level="8.3.2.1" data-path="appendix.html"><a href="appendix.html#yolo-benchmark-and-table-transformer"><i class="fa fa-check"></i><b>8.3.2.1</b> yolo benchmark and table transformer</a></li>
<li class="chapter" data-level="8.3.2.2" data-path="appendix.html"><a href="appendix.html#old-classification-with-llm"><i class="fa fa-check"></i><b>8.3.2.2</b> old classification with llm</a></li>
</ul></li>
<li class="chapter" data-level="8.3.3" data-path="appendix.html"><a href="appendix.html#vllm-batch-speed"><i class="fa fa-check"></i><b>8.3.3</b> Large language model process speed</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="appendix.html"><a href="appendix.html#prompts"><i class="fa fa-check"></i><b>8.4</b> Prompts</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="appendix.html"><a href="appendix.html#toc-understanding-promts"><i class="fa fa-check"></i><b>8.4.1</b> TOC understanding</a></li>
<li class="chapter" data-level="8.4.2" data-path="appendix.html"><a href="appendix.html#classification-prompts"><i class="fa fa-check"></i><b>8.4.2</b> Classification</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="appendix.html"><a href="appendix.html#regex-page-identification-code"><i class="fa fa-check"></i><b>8.5</b> Regular expressions</a></li>
<li class="chapter" data-level="8.6" data-path="appendix.html"><a href="appendix.html#annual-comprehensive-financial-report-balance-sheet"><i class="fa fa-check"></i><b>8.6</b> Annual Comprehensive Financial Report Balance Sheet</a></li>
<li class="chapter" data-level="8.7" data-path="appendix.html"><a href="appendix.html#extraction-framework-flow-chart"><i class="fa fa-check"></i><b>8.7</b> Extraction framework flow chart</a></li>
<li class="chapter" data-level="8.8" data-path="appendix.html"><a href="appendix.html#regex-extraction-mistakes"><i class="fa fa-check"></i><b>8.8</b> Table extraction with regular expressions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i><b>9</b> Tables</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="tables.html"><a href="tables.html#classification-1"><i class="fa fa-check"></i><b>9.0.1</b> Classification</a></li>
<li class="chapter" data-level="9.0.2" data-path="tables.html"><a href="tables.html#table-extraction-3"><i class="fa fa-check"></i><b>9.0.2</b> Table extraction</a>
<ul>
<li class="chapter" data-level="9.0.2.1" data-path="tables.html"><a href="tables.html#hybrid-approach"><i class="fa fa-check"></i><b>9.0.2.1</b> Hybrid approach</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="figures.html"><a href="figures.html"><i class="fa fa-check"></i><b>10</b> Figures</a>
<ul>
<li class="chapter" data-level="10.1" data-path="figures.html"><a href="figures.html#page-identification-4"><i class="fa fa-check"></i><b>10.1</b> Page identification</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="figures.html"><a href="figures.html#regex-baseline-1"><i class="fa fa-check"></i><b>10.1.1</b> Regex baseline</a></li>
<li class="chapter" data-level="10.1.2" data-path="figures.html"><a href="figures.html#toc-understanding-1"><i class="fa fa-check"></i><b>10.1.2</b> TOC understanding</a></li>
<li class="chapter" data-level="10.1.3" data-path="figures.html"><a href="figures.html#classification-2"><i class="fa fa-check"></i><b>10.1.3</b> Classification</a>
<ul>
<li class="chapter" data-level="10.1.3.1" data-path="figures.html"><a href="figures.html#binary"><i class="fa fa-check"></i><b>10.1.3.1</b> Binary</a></li>
<li class="chapter" data-level="10.1.3.2" data-path="figures.html"><a href="figures.html#multi-class-classification-1"><i class="fa fa-check"></i><b>10.1.3.2</b> Multi-class classification</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="figures.html"><a href="figures.html#table-extraction-4"><i class="fa fa-check"></i><b>10.2</b> Table extraction</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="figures.html"><a href="figures.html#regex-approach"><i class="fa fa-check"></i><b>10.2.1</b> Regex approach</a>
<ul>
<li class="chapter" data-level="10.2.1.1" data-path="figures.html"><a href="figures.html#real-tables"><i class="fa fa-check"></i><b>10.2.1.1</b> Real tables</a></li>
<li class="chapter" data-level="10.2.1.2" data-path="figures.html"><a href="figures.html#synthetic-tables"><i class="fa fa-check"></i><b>10.2.1.2</b> Synthetic tables</a></li>
</ul></li>
<li class="chapter" data-level="10.2.2" data-path="figures.html"><a href="figures.html#real-tables-1"><i class="fa fa-check"></i><b>10.2.2</b> Real tables</a>
<ul>
<li class="chapter" data-level="10.2.2.1" data-path="figures.html"><a href="figures.html#examples-from-same-company"><i class="fa fa-check"></i><b>10.2.2.1</b> Examples from same company</a></li>
<li class="chapter" data-level="10.2.2.2" data-path="figures.html"><a href="figures.html#openai-models-1"><i class="fa fa-check"></i><b>10.2.2.2</b> OpenAI models</a></li>
<li class="chapter" data-level="10.2.2.3" data-path="figures.html"><a href="figures.html#hypotheses-5"><i class="fa fa-check"></i><b>10.2.2.3</b> Hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="10.2.3" data-path="figures.html"><a href="figures.html#synthetic-tables-1"><i class="fa fa-check"></i><b>10.2.3</b> Synthetic tables</a>
<ul>
<li class="chapter" data-level="10.2.3.1" data-path="figures.html"><a href="figures.html#confidence-5"><i class="fa fa-check"></i><b>10.2.3.1</b> Confidence</a></li>
</ul></li>
<li class="chapter" data-level="10.2.4" data-path="figures.html"><a href="figures.html#hybrid-approach-1"><i class="fa fa-check"></i><b>10.2.4</b> Hybrid approach</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="layout-testing.html"><a href="layout-testing.html"><i class="fa fa-check"></i><b>11</b> Layout testing</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Extraction of tabular data from annual reports with LLMs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="figures" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">10</span> Figures<a href="figures.html#figures" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>NA predicting</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="figures.html#cb122-1" tabindex="-1"></a>metrics <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb122-2"><a href="figures.html#cb122-2" tabindex="-1"></a></span>
<span id="cb122-3"><a href="figures.html#cb122-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>) {</span>
<span id="cb122-4"><a href="figures.html#cb122-4" tabindex="-1"></a>  <span class="co"># print(i)</span></span>
<span id="cb122-5"><a href="figures.html#cb122-5" tabindex="-1"></a>  precision <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">29</span><span class="sc">-</span>i)<span class="sc">/</span><span class="dv">58</span></span>
<span id="cb122-6"><a href="figures.html#cb122-6" tabindex="-1"></a>  recall <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb122-7"><a href="figures.html#cb122-7" tabindex="-1"></a>  F1 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>precision<span class="sc">*</span>recall<span class="sc">/</span>(precision<span class="sc">+</span>recall)</span>
<span id="cb122-8"><a href="figures.html#cb122-8" tabindex="-1"></a>  metrics[[i]] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">i =</span> i, <span class="at">perc_correct_num =</span> <span class="dv">0</span>, <span class="at">F1 =</span> F1, <span class="at">perc_correct_total =</span> (<span class="dv">58-2</span><span class="sc">*</span>i)<span class="sc">/</span><span class="dv">58</span>)</span>
<span id="cb122-9"><a href="figures.html#cb122-9" tabindex="-1"></a>}</span>
<span id="cb122-10"><a href="figures.html#cb122-10" tabindex="-1"></a></span>
<span id="cb122-11"><a href="figures.html#cb122-11" tabindex="-1"></a>metrics <span class="sc">%&gt;%</span> <span class="fu">tibble</span>() <span class="sc">%&gt;%</span> <span class="fu">unnest_wider</span>(<span class="st">&quot;.&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb122-12"><a href="figures.html#cb122-12" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>i, <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb122-13"><a href="figures.html#cb122-13" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb122-14"><a href="figures.html#cb122-14" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">2</span><span class="sc">*</span>i, <span class="at">y =</span> value, <span class="at">color =</span> metric)) <span class="sc">+</span></span>
<span id="cb122-15"><a href="figures.html#cb122-15" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">10</span>, <span class="at">linetype =</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb122-16"><a href="figures.html#cb122-16" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">40</span>, <span class="at">linetype =</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb122-17"><a href="figures.html#cb122-17" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb122-18"><a href="figures.html#cb122-18" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;number of numeric values in ground truth&quot;</span>,</span>
<span id="cb122-19"><a href="figures.html#cb122-19" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;metric score&quot;</span></span>
<span id="cb122-20"><a href="figures.html#cb122-20" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:display-extraction-metrics-full-NA"></span>
<img src="_main_files/figure-html/display-extraction-metrics-full-NA-1.png" alt="Displaying the performance metrics a LLMs response would have, if all predictions are 'null'. The area between the two dashed lines shows the number of numeric values found in the real Aktiva tables." width="100%" />
<p class="caption">
Figure 10.1: Displaying the performance metrics a LLMs response would have, if all predictions are ‘null’. The area between the two dashed lines shows the number of numeric values found in the real Aktiva tables.
</p>
</div>
<div id="page-identification-4" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Page identification<a href="figures.html#page-identification-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="regex-baseline-1" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Regex baseline<a href="figures.html#regex-baseline-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="figures.html#cb123-1" tabindex="-1"></a>metrics_plot_regex_page_identification</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:display-metrics-plot-regex-page-identification"></span>
<img src="_main_files/figure-html/display-metrics-plot-regex-page-identification-1.png" alt="Comparing page identification metrics for different regular expressions for each classification task by type of the target table." width="100%" />
<p class="caption">
Figure 10.2: Comparing page identification metrics for different regular expressions for each classification task by type of the target table.
</p>
</div>
</div>
<div id="toc-understanding-1" class="section level3 hasAnchor" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> TOC understanding<a href="figures.html#toc-understanding-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="figures.html#cb124-1" tabindex="-1"></a>balanced_df_toc_benchmark <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb124-2"><a href="figures.html#cb124-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">fill =</span> in_range, <span class="at">colour =</span> min_distance <span class="sc">&lt;=</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb124-3"><a href="figures.html#cb124-3" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb124-4"><a href="figures.html#cb124-4" tabindex="-1"></a>    <span class="at">data =</span> balanced_df_toc_benchmark <span class="sc">%&gt;%</span> <span class="fu">filter</span>(in_range <span class="sc">==</span> <span class="cn">TRUE</span>),</span>
<span id="cb124-5"><a href="figures.html#cb124-5" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(perc_correct, <span class="dv">2</span>), <span class="st">&quot;&quot;</span>)),</span>
<span id="cb124-6"><a href="figures.html#cb124-6" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;count&quot;</span>,</span>
<span id="cb124-7"><a href="figures.html#cb124-7" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">1.2</span>,</span>
<span id="cb124-8"><a href="figures.html#cb124-8" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb124-9"><a href="figures.html#cb124-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb124-10"><a href="figures.html#cb124-10" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb124-11"><a href="figures.html#cb124-11" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="dv">1</span><span class="sc">-</span>perc_correct, <span class="dv">2</span>), <span class="st">&quot;&quot;</span>)),</span>
<span id="cb124-12"><a href="figures.html#cb124-12" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;count&quot;</span>,</span>
<span id="cb124-13"><a href="figures.html#cb124-13" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">1.5</span>,</span>
<span id="cb124-14"><a href="figures.html#cb124-14" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb124-15"><a href="figures.html#cb124-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb124-16"><a href="figures.html#cb124-16" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>benchmark_type, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="co"># +</span></span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:page-identification-toc-analysis-balanced"></span>
<img src="_main_files/figure-html/page-identification-toc-analysis-balanced-1.png" alt="Comparing number of fount TOC and amount of correct and incorrect predicted page ranges" width="100%" />
<p class="caption">
Figure 10.3: Comparing number of fount TOC and amount of correct and incorrect predicted page ranges
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="figures.html#cb125-1" tabindex="-1"></a>  <span class="co"># theme(</span></span>
<span id="cb125-2"><a href="figures.html#cb125-2" tabindex="-1"></a>  <span class="co">#   legend.position = &quot;bottom&quot;</span></span>
<span id="cb125-3"><a href="figures.html#cb125-3" tabindex="-1"></a>  <span class="co"># )</span></span></code></pre></div>
</details>
</div>
<div id="classification-2" class="section level3 hasAnchor" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> Classification<a href="figures.html#classification-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="binary" class="section level4 hasAnchor" number="10.1.3.1">
<h4><span class="header-section-number">10.1.3.1</span> Binary<a href="figures.html#binary" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Binary classification F1 score over runtime limited to 60 minutes</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="figures.html#cb126-1" tabindex="-1"></a>design <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb126-2"><a href="figures.html#cb126-2" tabindex="-1"></a><span class="st">ABCD##X</span></span>
<span id="cb126-3"><a href="figures.html#cb126-3" tabindex="-1"></a><span class="st">EFGHI#Y</span></span>
<span id="cb126-4"><a href="figures.html#cb126-4" tabindex="-1"></a><span class="st">JKL####</span></span>
<span id="cb126-5"><a href="figures.html#cb126-5" tabindex="-1"></a><span class="st">MNOPQRS</span></span>
<span id="cb126-6"><a href="figures.html#cb126-6" tabindex="-1"></a><span class="st">TUVW###</span></span>
<span id="cb126-7"><a href="figures.html#cb126-7" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb126-8"><a href="figures.html#cb126-8" tabindex="-1"></a></span>
<span id="cb126-9"><a href="figures.html#cb126-9" tabindex="-1"></a>df_binary <span class="sc">%&gt;%</span> <span class="fu">filter</span>(classification_type <span class="sc">==</span> <span class="st">&quot;Aktiva&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-10"><a href="figures.html#cb126-10" tabindex="-1"></a>  <span class="fu">filter</span>(loop <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model <span class="sc">%in%</span> model_by_size_classification) <span class="sc">%&gt;%</span> </span>
<span id="cb126-11"><a href="figures.html#cb126-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">norm_runtime =</span> norm_runtime<span class="sc">/</span><span class="dv">60</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-12"><a href="figures.html#cb126-12" tabindex="-1"></a>  <span class="fu">filter</span>(n_examples <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">|</span> <span class="fu">is.na</span>(n_examples)) <span class="sc">%&gt;%</span> </span>
<span id="cb126-13"><a href="figures.html#cb126-13" tabindex="-1"></a>  <span class="co"># left_join(model_letters, by = &quot;model&quot;) %&gt;%</span></span>
<span id="cb126-14"><a href="figures.html#cb126-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> norm_runtime, <span class="at">y =</span> f1_score)) <span class="sc">+</span></span>
<span id="cb126-15"><a href="figures.html#cb126-15" tabindex="-1"></a>  <span class="co"># ggplot(aes(x = norm_runtime, y = recall)) +</span></span>
<span id="cb126-16"><a href="figures.html#cb126-16" tabindex="-1"></a>  <span class="co"># ggplot(aes(x = norm_runtime, y = precision)) +</span></span>
<span id="cb126-17"><a href="figures.html#cb126-17" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> method_family, <span class="at">shape =</span> out_of_company), <span class="at">size =</span> <span class="dv">7</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb126-18"><a href="figures.html#cb126-18" tabindex="-1"></a>  <span class="fu">scale_shape</span>(<span class="at">na.value =</span> <span class="dv">15</span>, <span class="at">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="sc">+</span></span>
<span id="cb126-19"><a href="figures.html#cb126-19" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n_examples)) <span class="sc">+</span></span>
<span id="cb126-20"><a href="figures.html#cb126-20" tabindex="-1"></a>  <span class="co"># facet_grid(classification_type~model) +</span></span>
<span id="cb126-21"><a href="figures.html#cb126-21" tabindex="-1"></a>  ggh4x<span class="sc">::</span><span class="fu">facet_manual</span>(<span class="sc">~</span><span class="fu">factor</span>(model, <span class="at">levels =</span> model_by_size_classification), <span class="at">design =</span> design) <span class="sc">+</span></span>
<span id="cb126-22"><a href="figures.html#cb126-22" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb126-23"><a href="figures.html#cb126-23" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb126-24"><a href="figures.html#cb126-24" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>),</span>
<span id="cb126-25"><a href="figures.html#cb126-25" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb126-26"><a href="figures.html#cb126-26" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb126-27"><a href="figures.html#cb126-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;normalized runtime in minutes&quot;</span>) <span class="sc">+</span></span>
<span id="cb126-28"><a href="figures.html#cb126-28" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:binary-classification-performance-over-runtime"></span>
<img src="_main_files/figure-html/binary-classification-performance-over-runtime-1.png" alt="Comparing F1 score over normalized runtime for binary classification task. The normalized runtime is given in minutes of processing on a single B200. The time to load the model into the VRAM is excluded. Focussing on small models showing only 60 minutes of runtime." width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.4: Comparing F1 score over normalized runtime for binary classification task. The normalized runtime is given in minutes of processing on a single B200. The time to load the model into the VRAM is excluded. Focussing on small models showing only 60 minutes of runtime.
</p>
</div>
<p>Binary classification F1 score over runtime unlimited</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="figures.html#cb127-1" tabindex="-1"></a>df_binary <span class="sc">%&gt;%</span> <span class="fu">filter</span>(classification_type <span class="sc">==</span> <span class="st">&quot;Aktiva&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-2"><a href="figures.html#cb127-2" tabindex="-1"></a>  <span class="fu">filter</span>(loop <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model <span class="sc">%in%</span> model_by_size_classification) <span class="sc">%&gt;%</span> </span>
<span id="cb127-3"><a href="figures.html#cb127-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">norm_runtime =</span> norm_runtime<span class="sc">/</span><span class="dv">60</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-4"><a href="figures.html#cb127-4" tabindex="-1"></a>  <span class="fu">filter</span>(n_examples <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">|</span> <span class="fu">is.na</span>(n_examples)) <span class="sc">%&gt;%</span> </span>
<span id="cb127-5"><a href="figures.html#cb127-5" tabindex="-1"></a>  <span class="co"># left_join(model_letters, by = &quot;model&quot;) %&gt;%</span></span>
<span id="cb127-6"><a href="figures.html#cb127-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> norm_runtime, <span class="at">y =</span> f1_score)) <span class="sc">+</span></span>
<span id="cb127-7"><a href="figures.html#cb127-7" tabindex="-1"></a>  <span class="co"># ggplot(aes(x = norm_runtime, y = recall)) +</span></span>
<span id="cb127-8"><a href="figures.html#cb127-8" tabindex="-1"></a>  <span class="co"># ggplot(aes(x = norm_runtime, y = precision)) +</span></span>
<span id="cb127-9"><a href="figures.html#cb127-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> method_family, <span class="at">shape =</span> out_of_company), <span class="at">size =</span> <span class="dv">7</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb127-10"><a href="figures.html#cb127-10" tabindex="-1"></a>  <span class="fu">scale_shape</span>(<span class="at">na.value =</span> <span class="dv">15</span>, <span class="at">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="sc">+</span></span>
<span id="cb127-11"><a href="figures.html#cb127-11" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n_examples)) <span class="sc">+</span></span>
<span id="cb127-12"><a href="figures.html#cb127-12" tabindex="-1"></a>  <span class="co"># facet_grid(classification_type~model) +</span></span>
<span id="cb127-13"><a href="figures.html#cb127-13" tabindex="-1"></a>  ggh4x<span class="sc">::</span><span class="fu">facet_manual</span>(<span class="sc">~</span><span class="fu">factor</span>(model, <span class="at">levels =</span> model_by_size_classification), <span class="at">design =</span> design) <span class="sc">+</span></span>
<span id="cb127-14"><a href="figures.html#cb127-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb127-15"><a href="figures.html#cb127-15" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb127-16"><a href="figures.html#cb127-16" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>),</span>
<span id="cb127-17"><a href="figures.html#cb127-17" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb127-18"><a href="figures.html#cb127-18" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb127-19"><a href="figures.html#cb127-19" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;normalized runtime in minutes&quot;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:binary-classification-performance-over-runtime-full-time"></span>
<img src="_main_files/figure-html/binary-classification-performance-over-runtime-full-time-1.png" alt="Comparing F1 score over normalized runtime for binary classification task. The normalized runtime is given in minutes of processing on a single B200. The time to load the model into the VRAM is excluded." width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.5: Comparing F1 score over normalized runtime for binary classification task. The normalized runtime is given in minutes of processing on a single B200. The time to load the model into the VRAM is excluded.
</p>
</div>
</div>
<div id="multi-class-classification-1" class="section level4 hasAnchor" number="10.1.3.2">
<h4><span class="header-section-number">10.1.3.2</span> Multi-class classification<a href="figures.html#multi-class-classification-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Multi-class classification micro minorites F1 score over runtime limited to 60 minutes</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="figures.html#cb128-1" tabindex="-1"></a>design <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb128-2"><a href="figures.html#cb128-2" tabindex="-1"></a><span class="st">ABCD##X</span></span>
<span id="cb128-3"><a href="figures.html#cb128-3" tabindex="-1"></a><span class="st">EFGHI#Y</span></span>
<span id="cb128-4"><a href="figures.html#cb128-4" tabindex="-1"></a><span class="st">JKL####</span></span>
<span id="cb128-5"><a href="figures.html#cb128-5" tabindex="-1"></a><span class="st">MNOPQRS</span></span>
<span id="cb128-6"><a href="figures.html#cb128-6" tabindex="-1"></a><span class="st">TUVW###</span></span>
<span id="cb128-7"><a href="figures.html#cb128-7" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb128-8"><a href="figures.html#cb128-8" tabindex="-1"></a></span>
<span id="cb128-9"><a href="figures.html#cb128-9" tabindex="-1"></a>df_multi <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(metrics) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(metric_type <span class="sc">==</span> <span class="st">&quot;micro_minorities&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb128-10"><a href="figures.html#cb128-10" tabindex="-1"></a>  <span class="fu">filter</span>(loop <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model <span class="sc">%in%</span> model_by_size_classification) <span class="sc">%&gt;%</span> </span>
<span id="cb128-11"><a href="figures.html#cb128-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">norm_runtime =</span> norm_runtime<span class="sc">/</span><span class="dv">60</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb128-12"><a href="figures.html#cb128-12" tabindex="-1"></a>  <span class="fu">filter</span>(n_examples <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">|</span> <span class="fu">is.na</span>(n_examples)) <span class="sc">%&gt;%</span> </span>
<span id="cb128-13"><a href="figures.html#cb128-13" tabindex="-1"></a>  <span class="co"># left_join(model_letters, by = &quot;model&quot;) %&gt;%</span></span>
<span id="cb128-14"><a href="figures.html#cb128-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> norm_runtime, <span class="at">y =</span> f1_score)) <span class="sc">+</span></span>
<span id="cb128-15"><a href="figures.html#cb128-15" tabindex="-1"></a>  <span class="co"># ggplot(aes(x = norm_runtime, y = recall)) +</span></span>
<span id="cb128-16"><a href="figures.html#cb128-16" tabindex="-1"></a>  <span class="co"># ggplot(aes(x = norm_runtime, y = precision)) +</span></span>
<span id="cb128-17"><a href="figures.html#cb128-17" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> method_family, <span class="at">shape =</span> out_of_company), <span class="at">size =</span> <span class="dv">7</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb128-18"><a href="figures.html#cb128-18" tabindex="-1"></a>  <span class="fu">scale_shape</span>(<span class="at">na.value =</span> <span class="dv">15</span>, <span class="at">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="sc">+</span></span>
<span id="cb128-19"><a href="figures.html#cb128-19" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n_examples)) <span class="sc">+</span></span>
<span id="cb128-20"><a href="figures.html#cb128-20" tabindex="-1"></a>  <span class="co"># facet_grid(classification_type~model) +</span></span>
<span id="cb128-21"><a href="figures.html#cb128-21" tabindex="-1"></a>  ggh4x<span class="sc">::</span><span class="fu">facet_manual</span>(<span class="sc">~</span><span class="fu">factor</span>(model, <span class="at">levels =</span> model_by_size_classification), <span class="at">design =</span> design) <span class="sc">+</span></span>
<span id="cb128-22"><a href="figures.html#cb128-22" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb128-23"><a href="figures.html#cb128-23" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb128-24"><a href="figures.html#cb128-24" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>),</span>
<span id="cb128-25"><a href="figures.html#cb128-25" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb128-26"><a href="figures.html#cb128-26" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb128-27"><a href="figures.html#cb128-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;normalized runtime in minutes&quot;</span>) <span class="sc">+</span></span>
<span id="cb128-28"><a href="figures.html#cb128-28" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:multi-classification-performance-over-runtime"></span>
<img src="_main_files/figure-html/multi-classification-performance-over-runtime-1.png" alt="Comparing F1 score over normalized runtime for multi-class classification task. The normalized runtime is given in minutes of processing on a single B200. The time to load the model into the VRAM is excluded. Focussing on small models showing only 60 minutes of runtime." width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.6: Comparing F1 score over normalized runtime for multi-class classification task. The normalized runtime is given in minutes of processing on a single B200. The time to load the model into the VRAM is excluded. Focussing on small models showing only 60 minutes of runtime.
</p>
</div>
<p>Multi-class classification micro minorites F1 score over runtime</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="figures.html#cb129-1" tabindex="-1"></a>design <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb129-2"><a href="figures.html#cb129-2" tabindex="-1"></a><span class="st">ABCD##X</span></span>
<span id="cb129-3"><a href="figures.html#cb129-3" tabindex="-1"></a><span class="st">EFGHI#Y</span></span>
<span id="cb129-4"><a href="figures.html#cb129-4" tabindex="-1"></a><span class="st">JKL####</span></span>
<span id="cb129-5"><a href="figures.html#cb129-5" tabindex="-1"></a><span class="st">MNOPQRS</span></span>
<span id="cb129-6"><a href="figures.html#cb129-6" tabindex="-1"></a><span class="st">TUVW###</span></span>
<span id="cb129-7"><a href="figures.html#cb129-7" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb129-8"><a href="figures.html#cb129-8" tabindex="-1"></a></span>
<span id="cb129-9"><a href="figures.html#cb129-9" tabindex="-1"></a>df_multi <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(metrics) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(metric_type <span class="sc">==</span> <span class="st">&quot;micro_minorities&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb129-10"><a href="figures.html#cb129-10" tabindex="-1"></a>  <span class="fu">filter</span>(loop <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model <span class="sc">%in%</span> model_by_size_classification) <span class="sc">%&gt;%</span> </span>
<span id="cb129-11"><a href="figures.html#cb129-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">norm_runtime =</span> norm_runtime<span class="sc">/</span><span class="dv">60</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb129-12"><a href="figures.html#cb129-12" tabindex="-1"></a>  <span class="fu">filter</span>(n_examples <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">|</span> <span class="fu">is.na</span>(n_examples)) <span class="sc">%&gt;%</span> </span>
<span id="cb129-13"><a href="figures.html#cb129-13" tabindex="-1"></a>  <span class="co"># left_join(model_letters, by = &quot;model&quot;) %&gt;%</span></span>
<span id="cb129-14"><a href="figures.html#cb129-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> norm_runtime, <span class="at">y =</span> f1_score)) <span class="sc">+</span></span>
<span id="cb129-15"><a href="figures.html#cb129-15" tabindex="-1"></a>  <span class="co"># ggplot(aes(x = norm_runtime, y = recall)) +</span></span>
<span id="cb129-16"><a href="figures.html#cb129-16" tabindex="-1"></a>  <span class="co"># ggplot(aes(x = norm_runtime, y = precision)) +</span></span>
<span id="cb129-17"><a href="figures.html#cb129-17" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> method_family, <span class="at">shape =</span> out_of_company), <span class="at">size =</span> <span class="dv">7</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb129-18"><a href="figures.html#cb129-18" tabindex="-1"></a>  <span class="fu">scale_shape</span>(<span class="at">na.value =</span> <span class="dv">15</span>, <span class="at">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="sc">+</span></span>
<span id="cb129-19"><a href="figures.html#cb129-19" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n_examples)) <span class="sc">+</span></span>
<span id="cb129-20"><a href="figures.html#cb129-20" tabindex="-1"></a>  <span class="co"># facet_grid(classification_type~model) +</span></span>
<span id="cb129-21"><a href="figures.html#cb129-21" tabindex="-1"></a>  ggh4x<span class="sc">::</span><span class="fu">facet_manual</span>(<span class="sc">~</span><span class="fu">factor</span>(model, <span class="at">levels =</span> model_by_size_classification), <span class="at">design =</span> design) <span class="sc">+</span></span>
<span id="cb129-22"><a href="figures.html#cb129-22" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb129-23"><a href="figures.html#cb129-23" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb129-24"><a href="figures.html#cb129-24" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>),</span>
<span id="cb129-25"><a href="figures.html#cb129-25" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb129-26"><a href="figures.html#cb129-26" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb129-27"><a href="figures.html#cb129-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;normalized runtime in minutes&quot;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:multi-classification-performance-over-runtime-full-time"></span>
<img src="_main_files/figure-html/multi-classification-performance-over-runtime-full-time-1.png" alt="Comparing F1 score over normalized runtime for multi-class classification task. The normalized runtime is given in minutes of processing on a single B200. The time to load the model into the VRAM is excluded." width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.7: Comparing F1 score over normalized runtime for multi-class classification task. The normalized runtime is given in minutes of processing on a single B200. The time to load the model into the VRAM is excluded.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="figures.html#cb130-1" tabindex="-1"></a>model_name <span class="ot">&lt;-</span> <span class="st">&quot;Llama-4-Scout-17B-16E-Instruct&quot;</span></span>
<span id="cb130-2"><a href="figures.html#cb130-2" tabindex="-1"></a>method_name <span class="ot">&lt;-</span> <span class="st">&quot;3_rag_examples&quot;</span></span>
<span id="cb130-3"><a href="figures.html#cb130-3" tabindex="-1"></a></span>
<span id="cb130-4"><a href="figures.html#cb130-4" tabindex="-1"></a>df_temp_llama_multi <span class="ot">&lt;-</span> df_multi <span class="sc">%&gt;%</span> </span>
<span id="cb130-5"><a href="figures.html#cb130-5" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb130-6"><a href="figures.html#cb130-6" tabindex="-1"></a>    model <span class="sc">==</span> model_name,</span>
<span id="cb130-7"><a href="figures.html#cb130-7" tabindex="-1"></a>    method <span class="sc">==</span> method_name</span>
<span id="cb130-8"><a href="figures.html#cb130-8" tabindex="-1"></a>  ) <span class="co"># %&gt;% unnest(metrics) # %&gt;% calc_micro_f1(model, method)</span></span>
<span id="cb130-9"><a href="figures.html#cb130-9" tabindex="-1"></a>p_aktiva <span class="ot">&lt;-</span> df_temp_llama_multi <span class="sc">%&gt;%</span> <span class="fu">plot_pr_double_curve_multi</span>(<span class="st">&quot;Aktiva&quot;</span>, <span class="at">x_stuff =</span> <span class="cn">FALSE</span>)</span>
<span id="cb130-10"><a href="figures.html#cb130-10" tabindex="-1"></a>p_passiva <span class="ot">&lt;-</span> df_temp_llama_multi <span class="sc">%&gt;%</span> <span class="fu">plot_pr_double_curve_multi</span>(<span class="st">&quot;Passiva&quot;</span>, <span class="at">x_stuff =</span> <span class="cn">FALSE</span>)</span>
<span id="cb130-11"><a href="figures.html#cb130-11" tabindex="-1"></a>p_guv <span class="ot">&lt;-</span> df_temp_llama_multi <span class="sc">%&gt;%</span> <span class="fu">plot_pr_double_curve_multi</span>(<span class="st">&quot;GuV&quot;</span>, <span class="at">x_stuff =</span> <span class="cn">TRUE</span>)</span>
<span id="cb130-12"><a href="figures.html#cb130-12" tabindex="-1"></a></span>
<span id="cb130-13"><a href="figures.html#cb130-13" tabindex="-1"></a><span class="fu">wrap_elements</span>(p_aktiva) <span class="sc">/</span> <span class="fu">wrap_elements</span>(p_passiva) <span class="sc">/</span> <span class="fu">wrap_elements</span>(p_guv) <span class="sc">+</span></span>
<span id="cb130-14"><a href="figures.html#cb130-14" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb130-15"><a href="figures.html#cb130-15" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="fu">str_c</span>(model, <span class="st">&quot; with &quot;</span>, method))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:micro-pr-curve-llm-multi-llama-scout"></span>
<img src="_main_files/figure-html/micro-pr-curve-llm-multi-llama-scout-1.png" alt="Showing the precsion-recall-curve for Llama-4-Scout-17B-16E-Instruct." width="100%" />
<p class="caption">
Figure 10.8: Showing the precsion-recall-curve for Llama-4-Scout-17B-16E-Instruct.
</p>
</div>
</div>
</div>
</div>
<div id="table-extraction-4" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Table extraction<a href="figures.html#table-extraction-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="figures.html#cb131-1" tabindex="-1"></a>df_overview_synth <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">target_data =</span> <span class="st">&quot;synth&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb131-2"><a href="figures.html#cb131-2" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb131-3"><a href="figures.html#cb131-3" tabindex="-1"></a>    df_overview <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model <span class="sc">%in%</span> df_overview_synth<span class="sc">$</span>model) <span class="sc">%&gt;%</span> </span>
<span id="cb131-4"><a href="figures.html#cb131-4" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb131-5"><a href="figures.html#cb131-5" tabindex="-1"></a>        <span class="at">target_data =</span> <span class="st">&quot;real&quot;</span>, </span>
<span id="cb131-6"><a href="figures.html#cb131-6" tabindex="-1"></a>        <span class="at">n_examples =</span> <span class="fu">factor</span>(</span>
<span id="cb131-7"><a href="figures.html#cb131-7" tabindex="-1"></a>          n_examples, </span>
<span id="cb131-8"><a href="figures.html#cb131-8" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">levels</span>(df_overview_synth<span class="sc">$</span>n_examples), </span>
<span id="cb131-9"><a href="figures.html#cb131-9" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb131-10"><a href="figures.html#cb131-10" tabindex="-1"></a>          )</span>
<span id="cb131-11"><a href="figures.html#cb131-11" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>request_tokens)</span>
<span id="cb131-12"><a href="figures.html#cb131-12" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">as.numeric</span>(n_examples) <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb131-13"><a href="figures.html#cb131-13" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb131-14"><a href="figures.html#cb131-14" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> synth_table_extraction_regex_total_performance_median, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb131-15"><a href="figures.html#cb131-15" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> target_data, <span class="at">y =</span> percentage_correct_total, <span class="at">fill =</span> model_family)) <span class="sc">+</span></span>
<span id="cb131-16"><a href="figures.html#cb131-16" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb131-17"><a href="figures.html#cb131-17" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family <span class="sc">+</span> n_examples <span class="sc">~</span> model_family<span class="sc">+</span>model) <span class="sc">+</span></span>
<span id="cb131-18"><a href="figures.html#cb131-18" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb131-19"><a href="figures.html#cb131-19" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb131-20"><a href="figures.html#cb131-20" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:comparing-table-extraction-performance-among-real-and-synth-aktiva-data"></span>
<img src="_main_files/figure-html/comparing-table-extraction-performance-among-real-and-synth-aktiva-data-1.png" alt="Comparing the table extraction performance among real and synthetic Aktiva tables" width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.9: Comparing the table extraction performance among real and synthetic Aktiva tables
</p>
</div>
<div id="regex-approach" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Regex approach<a href="figures.html#regex-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="real-tables" class="section level4 hasAnchor" number="10.2.1.1">
<h4><span class="header-section-number">10.2.1.1</span> Real tables<a href="figures.html#real-tables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="figures.html#cb132-1" tabindex="-1"></a>real_table_extraction_regex_shap_plot</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:real-table-extraction-regex-shap-plot"></span>
<img src="_main_files/figure-html/real-table-extraction-regex-shap-plot-1.png" alt="Mean absolute SHAP values and beeswarm plots for real table extraction with regular expression approach" width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.10: Mean absolute SHAP values and beeswarm plots for real table extraction with regular expression approach
</p>
</div>
</div>
<div id="synthetic-tables" class="section level4 hasAnchor" number="10.2.1.2">
<h4><span class="header-section-number">10.2.1.2</span> Synthetic tables<a href="figures.html#synthetic-tables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="figures.html#cb133-1" tabindex="-1"></a>synth_table_extraction_regex_shap_plot</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:synth-table-extraction-regex-shap-plot"></span>
<img src="_main_files/figure-html/synth-table-extraction-regex-shap-plot-1.png" alt="Mean absolute SHAP values and beeswarm plots for synth table extraction with regular expression approach" width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.11: Mean absolute SHAP values and beeswarm plots for synth table extraction with regular expression approach
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="figures.html#cb134-1" tabindex="-1"></a>shap_f1_extraction_backend</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:synth-table-extraction-regex-dependence-plot-backend"></span>
<img src="_main_files/figure-html/synth-table-extraction-regex-dependence-plot-backend-1.png" alt="Showing the interactions of the extraction backend pdfium with the table characteristics for F1 score." width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.12: Showing the interactions of the extraction backend pdfium with the table characteristics for F1 score.
</p>
</div>
</div>
</div>
<div id="real-tables-1" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Real tables<a href="figures.html#real-tables-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="figures.html#cb135-1" tabindex="-1"></a>design <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb135-2"><a href="figures.html#cb135-2" tabindex="-1"></a>   <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">29</span>,<span class="dv">30</span>,  </span>
<span id="cb135-3"><a href="figures.html#cb135-3" tabindex="-1"></a>   <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>,<span class="dv">10</span>,<span class="cn">NA</span>, <span class="dv">4</span>, <span class="dv">5</span>,</span>
<span id="cb135-4"><a href="figures.html#cb135-4" tabindex="-1"></a>  <span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span>
<span id="cb135-5"><a href="figures.html#cb135-5" tabindex="-1"></a>  <span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="cn">NA</span>,</span>
<span id="cb135-6"><a href="figures.html#cb135-6" tabindex="-1"></a>  <span class="dv">21</span>,<span class="dv">22</span>,<span class="dv">23</span>,<span class="dv">24</span>,<span class="dv">25</span>,<span class="dv">26</span>,<span class="dv">27</span>,<span class="dv">28</span></span>
<span id="cb135-7"><a href="figures.html#cb135-7" tabindex="-1"></a>  ), <span class="dv">5</span>, <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-8"><a href="figures.html#cb135-8" tabindex="-1"></a></span>
<span id="cb135-9"><a href="figures.html#cb135-9" tabindex="-1"></a>df_overview <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(</span>
<span id="cb135-10"><a href="figures.html#cb135-10" tabindex="-1"></a>  model, method, method_family, out_of_company, n_examples</span>
<span id="cb135-11"><a href="figures.html#cb135-11" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb135-12"><a href="figures.html#cb135-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_examples =</span> <span class="fu">str_remove</span>(<span class="fu">as.character</span>(n_examples), <span class="st">&quot;n = &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb135-13"><a href="figures.html#cb135-13" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb135-14"><a href="figures.html#cb135-14" tabindex="-1"></a>    <span class="at">mean_total =</span> <span class="fu">mean</span>(percentage_correct_total, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb135-15"><a href="figures.html#cb135-15" tabindex="-1"></a>    <span class="at">mean_runtime =</span> <span class="fu">mean</span>(normalized_runtime, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb135-16"><a href="figures.html#cb135-16" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb135-17"><a href="figures.html#cb135-17" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_runtime, <span class="at">y =</span> mean_total)) <span class="sc">+</span></span>
<span id="cb135-18"><a href="figures.html#cb135-18" tabindex="-1"></a>  <span class="co"># ggplot(aes(x = norm_runtime, y = recall)) +</span></span>
<span id="cb135-19"><a href="figures.html#cb135-19" tabindex="-1"></a>  <span class="co"># ggplot(aes(x = norm_runtime, y = precision)) +</span></span>
<span id="cb135-20"><a href="figures.html#cb135-20" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> method_family, <span class="at">shape =</span> out_of_company), <span class="at">size =</span> <span class="dv">7</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb135-21"><a href="figures.html#cb135-21" tabindex="-1"></a>  <span class="fu">scale_shape</span>(<span class="at">na.value =</span> <span class="dv">15</span>, <span class="at">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="sc">+</span></span>
<span id="cb135-22"><a href="figures.html#cb135-22" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n_examples)) <span class="sc">+</span></span>
<span id="cb135-23"><a href="figures.html#cb135-23" tabindex="-1"></a>  <span class="co"># facet_grid(classification_type~model) +</span></span>
<span id="cb135-24"><a href="figures.html#cb135-24" tabindex="-1"></a>  ggh4x<span class="sc">::</span><span class="fu">facet_manual</span>(<span class="sc">~</span><span class="fu">factor</span>(model, <span class="at">levels =</span> model_by_size), <span class="at">design =</span> design) <span class="sc">+</span></span>
<span id="cb135-25"><a href="figures.html#cb135-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb135-26"><a href="figures.html#cb135-26" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb135-27"><a href="figures.html#cb135-27" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>),</span>
<span id="cb135-28"><a href="figures.html#cb135-28" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb135-29"><a href="figures.html#cb135-29" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb135-30"><a href="figures.html#cb135-30" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;normalized runtime in minutes&quot;</span>) <span class="sc">+</span></span>
<span id="cb135-31"><a href="figures.html#cb135-31" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:real-table-extraction-performance-over-runtime"></span>
<img src="_main_files/figure-html/real-table-extraction-performance-over-runtime-1.png" alt="Comparing percentage of correct predictions total over the normalized runtime. The normalized runtime is given in minutes of processing on a single B200. The time to load the model into the VRAM is excluded. Focussing on small models showing only 5 minutes of runtime." width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.13: Comparing percentage of correct predictions total over the normalized runtime. The normalized runtime is given in minutes of processing on a single B200. The time to load the model into the VRAM is excluded. Focussing on small models showing only 5 minutes of runtime.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="figures.html#cb136-1" tabindex="-1"></a>design <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb136-2"><a href="figures.html#cb136-2" tabindex="-1"></a>   <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">29</span>,<span class="dv">30</span>,  </span>
<span id="cb136-3"><a href="figures.html#cb136-3" tabindex="-1"></a>   <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>,<span class="dv">10</span>,<span class="cn">NA</span>, <span class="dv">4</span>, <span class="dv">5</span>,</span>
<span id="cb136-4"><a href="figures.html#cb136-4" tabindex="-1"></a>  <span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span>
<span id="cb136-5"><a href="figures.html#cb136-5" tabindex="-1"></a>  <span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="cn">NA</span>,</span>
<span id="cb136-6"><a href="figures.html#cb136-6" tabindex="-1"></a>  <span class="dv">21</span>,<span class="dv">22</span>,<span class="dv">23</span>,<span class="dv">24</span>,<span class="dv">25</span>,<span class="dv">26</span>,<span class="dv">27</span>,<span class="dv">28</span></span>
<span id="cb136-7"><a href="figures.html#cb136-7" tabindex="-1"></a>  ), <span class="dv">5</span>, <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb136-8"><a href="figures.html#cb136-8" tabindex="-1"></a></span>
<span id="cb136-9"><a href="figures.html#cb136-9" tabindex="-1"></a>df_overview <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(</span>
<span id="cb136-10"><a href="figures.html#cb136-10" tabindex="-1"></a>  model, method, method_family, out_of_company, n_examples</span>
<span id="cb136-11"><a href="figures.html#cb136-11" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb136-12"><a href="figures.html#cb136-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_examples =</span> <span class="fu">str_remove</span>(<span class="fu">as.character</span>(n_examples), <span class="st">&quot;n = &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb136-13"><a href="figures.html#cb136-13" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb136-14"><a href="figures.html#cb136-14" tabindex="-1"></a>    <span class="at">mean_total =</span> <span class="fu">mean</span>(percentage_correct_total, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb136-15"><a href="figures.html#cb136-15" tabindex="-1"></a>    <span class="at">mean_runtime =</span> <span class="fu">mean</span>(normalized_runtime, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb136-16"><a href="figures.html#cb136-16" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb136-17"><a href="figures.html#cb136-17" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_runtime, <span class="at">y =</span> mean_total)) <span class="sc">+</span></span>
<span id="cb136-18"><a href="figures.html#cb136-18" tabindex="-1"></a>  <span class="co"># ggplot(aes(x = norm_runtime, y = recall)) +</span></span>
<span id="cb136-19"><a href="figures.html#cb136-19" tabindex="-1"></a>  <span class="co"># ggplot(aes(x = norm_runtime, y = precision)) +</span></span>
<span id="cb136-20"><a href="figures.html#cb136-20" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> method_family, <span class="at">shape =</span> out_of_company), <span class="at">size =</span> <span class="dv">7</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb136-21"><a href="figures.html#cb136-21" tabindex="-1"></a>  <span class="fu">scale_shape</span>(<span class="at">na.value =</span> <span class="dv">15</span>, <span class="at">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="sc">+</span></span>
<span id="cb136-22"><a href="figures.html#cb136-22" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n_examples)) <span class="sc">+</span></span>
<span id="cb136-23"><a href="figures.html#cb136-23" tabindex="-1"></a>  <span class="co"># facet_grid(classification_type~model) +</span></span>
<span id="cb136-24"><a href="figures.html#cb136-24" tabindex="-1"></a>  ggh4x<span class="sc">::</span><span class="fu">facet_manual</span>(<span class="sc">~</span><span class="fu">factor</span>(model, <span class="at">levels =</span> model_by_size), <span class="at">design =</span> design) <span class="sc">+</span></span>
<span id="cb136-25"><a href="figures.html#cb136-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb136-26"><a href="figures.html#cb136-26" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb136-27"><a href="figures.html#cb136-27" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>),</span>
<span id="cb136-28"><a href="figures.html#cb136-28" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb136-29"><a href="figures.html#cb136-29" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb136-30"><a href="figures.html#cb136-30" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;normalized runtime in minutes&quot;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:real-table-extraction-performance-over-runtime-full"></span>
<img src="_main_files/figure-html/real-table-extraction-performance-over-runtime-full-1.png" alt="Comparing percentage of correct predictions total over the normalized runtime. The normalized runtime is given in minutes of processing on a single B200. The time to load the model into the VRAM is excluded. Showing the full runtime range." width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.14: Comparing percentage of correct predictions total over the normalized runtime. The normalized runtime is given in minutes of processing on a single B200. The time to load the model into the VRAM is excluded. Showing the full runtime range.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="figures.html#cb137-1" tabindex="-1"></a>df_overview <span class="sc">%&gt;%</span> </span>
<span id="cb137-2"><a href="figures.html#cb137-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb137-3"><a href="figures.html#cb137-3" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> real_table_extraction_regex_total_performance_median, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb137-4"><a href="figures.html#cb137-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> percentage_correct_total, <span class="at">fill =</span> model_family)) <span class="sc">+</span></span>
<span id="cb137-5"><a href="figures.html#cb137-5" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb137-6"><a href="figures.html#cb137-6" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family <span class="sc">+</span> n_examples <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb137-7"><a href="figures.html#cb137-7" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb137-8"><a href="figures.html#cb137-8" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb137-9"><a href="figures.html#cb137-9" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:table-extraction-llm-performance-total-overview"></span>
<img src="_main_files/figure-html/table-extraction-llm-performance-total-overview-1.png" alt="Percentage of correct extracted or as missing categorized values for table extraction task on real Aktiva tables" width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.15: Percentage of correct extracted or as missing categorized values for table extraction task on real Aktiva tables
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="figures.html#cb138-1" tabindex="-1"></a>df_overview <span class="sc">%&gt;%</span> </span>
<span id="cb138-2"><a href="figures.html#cb138-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb138-3"><a href="figures.html#cb138-3" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> real_table_extraction_regex_num_performance_median, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb138-4"><a href="figures.html#cb138-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> percentage_correct_numeric, <span class="at">fill =</span> model_family)) <span class="sc">+</span></span>
<span id="cb138-5"><a href="figures.html#cb138-5" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb138-6"><a href="figures.html#cb138-6" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family <span class="sc">+</span> n_examples <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb138-7"><a href="figures.html#cb138-7" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb138-8"><a href="figures.html#cb138-8" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb138-9"><a href="figures.html#cb138-9" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:table-extraction-llm-performance-numeric-overview"></span>
<img src="_main_files/figure-html/table-extraction-llm-performance-numeric-overview-1.png" alt="Percentage of correct extracted numeric values for table extraction task on real Aktiva tables" width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.16: Percentage of correct extracted numeric values for table extraction task on real Aktiva tables
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="figures.html#cb139-1" tabindex="-1"></a>df_overview <span class="sc">%&gt;%</span> </span>
<span id="cb139-2"><a href="figures.html#cb139-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb139-3"><a href="figures.html#cb139-3" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> real_table_extraction_regex_NA_F1_median, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb139-4"><a href="figures.html#cb139-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> NA_F1, <span class="at">fill =</span> model_family)) <span class="sc">+</span></span>
<span id="cb139-5"><a href="figures.html#cb139-5" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb139-6"><a href="figures.html#cb139-6" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family <span class="sc">+</span> n_examples <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb139-7"><a href="figures.html#cb139-7" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb139-8"><a href="figures.html#cb139-8" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb139-9"><a href="figures.html#cb139-9" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:table-extraction-llm-f1-overview"></span>
<img src="_main_files/figure-html/table-extraction-llm-f1-overview-1.png" alt="F1 score for the missing classification if a value is missing for table extraction task on real Aktiva tables" width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.17: F1 score for the missing classification if a value is missing for table extraction task on real Aktiva tables
</p>
</div>
<div id="examples-from-same-company" class="section level4 hasAnchor" number="10.2.2.1">
<h4><span class="header-section-number">10.2.2.1</span> Examples from same company<a href="figures.html#examples-from-same-company" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="figures.html#cb140-1" tabindex="-1"></a>model_selection <span class="ot">&lt;-</span> <span class="fu">c</span>(model_by_size, <span class="st">&quot;gpt-4.1-nano&quot;</span>, <span class="st">&quot;gpt-5-nano&quot;</span>, <span class="st">&quot;gpt-4.1-mini&quot;</span>, <span class="st">&quot;gpt-5-mini&quot;</span>, <span class="st">&quot;gpt-4.1&quot;</span>)</span>
<span id="cb140-2"><a href="figures.html#cb140-2" tabindex="-1"></a></span>
<span id="cb140-3"><a href="figures.html#cb140-3" tabindex="-1"></a>df_temp <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df_real_table_extraction, df_real_table_extraction_azure) <span class="sc">%&gt;%</span> </span>
<span id="cb140-4"><a href="figures.html#cb140-4" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb140-5"><a href="figures.html#cb140-5" tabindex="-1"></a>    <span class="co"># str_detect(filepath, &quot;Statistik&quot;), </span></span>
<span id="cb140-6"><a href="figures.html#cb140-6" tabindex="-1"></a>    method_family <span class="sc">==</span> <span class="st">&quot;top_n_rag_examples&quot;</span>,</span>
<span id="cb140-7"><a href="figures.html#cb140-7" tabindex="-1"></a>    n_examples <span class="sc">!=</span> <span class="dv">2</span>,</span>
<span id="cb140-8"><a href="figures.html#cb140-8" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb140-9"><a href="figures.html#cb140-9" tabindex="-1"></a>  <span class="fu">filter</span>(model <span class="sc">%in%</span> model_selection) <span class="sc">%&gt;%</span></span>
<span id="cb140-10"><a href="figures.html#cb140-10" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb140-11"><a href="figures.html#cb140-11" tabindex="-1"></a>    <span class="at">model =</span> <span class="fu">factor</span>(model, <span class="at">levels =</span> model_selection),</span>
<span id="cb140-12"><a href="figures.html#cb140-12" tabindex="-1"></a>    <span class="at">model_family =</span> <span class="fu">factor</span>(model_family),</span>
<span id="cb140-13"><a href="figures.html#cb140-13" tabindex="-1"></a>    <span class="at">method_family =</span> <span class="fu">factor</span>(method_family, <span class="at">levels =</span> method_order),</span>
<span id="cb140-14"><a href="figures.html#cb140-14" tabindex="-1"></a>    <span class="at">n_examples =</span> <span class="fu">fct_rev</span>(<span class="fu">ordered</span>(<span class="fu">paste</span>(<span class="st">&quot;n =&quot;</span>, n_examples))),</span>
<span id="cb140-15"><a href="figures.html#cb140-15" tabindex="-1"></a>    <span class="at">examples_from_same_company =</span> <span class="sc">!</span>out_of_company</span>
<span id="cb140-16"><a href="figures.html#cb140-16" tabindex="-1"></a>  )</span>
<span id="cb140-17"><a href="figures.html#cb140-17" tabindex="-1"></a></span>
<span id="cb140-18"><a href="figures.html#cb140-18" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> df_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(model_family, <span class="st">&quot;Qwen&quot;</span>), model_family <span class="sc">!=</span> <span class="st">&quot;microsoft&quot;</span>, model_family <span class="sc">!=</span> <span class="st">&quot;tiiuae&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb140-19"><a href="figures.html#cb140-19" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> examples_from_same_company, <span class="at">y =</span> percentage_correct_total, <span class="at">fill =</span> model_family)) <span class="sc">+</span></span>
<span id="cb140-20"><a href="figures.html#cb140-20" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> real_table_extraction_regex_NA_F1_median, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb140-21"><a href="figures.html#cb140-21" tabindex="-1"></a>  <span class="co"># geom_jitter(</span></span>
<span id="cb140-22"><a href="figures.html#cb140-22" tabindex="-1"></a>  <span class="co">#   aes(x = examples_from_same_company, y = percentage_correct_total),</span></span>
<span id="cb140-23"><a href="figures.html#cb140-23" tabindex="-1"></a>  <span class="co">#   shape = 4, height = 0.005, alpha = .5</span></span>
<span id="cb140-24"><a href="figures.html#cb140-24" tabindex="-1"></a>  <span class="co">#   ) +</span></span>
<span id="cb140-25"><a href="figures.html#cb140-25" tabindex="-1"></a>  <span class="co"># scale_x_discrete(guide = guide_axis(angle = 30)) +</span></span>
<span id="cb140-26"><a href="figures.html#cb140-26" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">guide =</span> <span class="st">&quot;none&quot;</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb140-27"><a href="figures.html#cb140-27" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family <span class="sc">+</span> n_examples <span class="sc">~</span> model_family <span class="sc">+</span> model) <span class="sc">+</span></span>
<span id="cb140-28"><a href="figures.html#cb140-28" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb140-29"><a href="figures.html#cb140-29" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb140-30"><a href="figures.html#cb140-30" tabindex="-1"></a>    <span class="co"># axis.title.x = element_blank()</span></span>
<span id="cb140-31"><a href="figures.html#cb140-31" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb140-32"><a href="figures.html#cb140-32" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb140-33"><a href="figures.html#cb140-33" tabindex="-1"></a></span>
<span id="cb140-34"><a href="figures.html#cb140-34" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> df_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(</span>
<span id="cb140-35"><a href="figures.html#cb140-35" tabindex="-1"></a>  <span class="fu">str_detect</span>(model_family, <span class="st">&quot;Qwen&quot;</span>) <span class="sc">|</span> model_family <span class="sc">==</span> <span class="st">&quot;microsoft&quot;</span> <span class="sc">|</span> model_family <span class="sc">==</span> <span class="st">&quot;tiiuae&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb140-36"><a href="figures.html#cb140-36" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> examples_from_same_company, <span class="at">y =</span> percentage_correct_total, <span class="at">fill =</span> model_family), <span class="at">show.legend =</span> T) <span class="sc">+</span></span>
<span id="cb140-37"><a href="figures.html#cb140-37" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> real_table_extraction_regex_NA_F1_median, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb140-38"><a href="figures.html#cb140-38" tabindex="-1"></a>  <span class="co"># geom_jitter(</span></span>
<span id="cb140-39"><a href="figures.html#cb140-39" tabindex="-1"></a>  <span class="co">#   aes(x = examples_from_same_company, y = percentage_correct_total),</span></span>
<span id="cb140-40"><a href="figures.html#cb140-40" tabindex="-1"></a>  <span class="co">#   shape = 4, height = 0.005, alpha = .5</span></span>
<span id="cb140-41"><a href="figures.html#cb140-41" tabindex="-1"></a>  <span class="co">#   ) +</span></span>
<span id="cb140-42"><a href="figures.html#cb140-42" tabindex="-1"></a>  <span class="co"># scale_x_discrete(guide = guide_axis(angle = 30)) +</span></span>
<span id="cb140-43"><a href="figures.html#cb140-43" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">drop =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb140-44"><a href="figures.html#cb140-44" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family <span class="sc">+</span> n_examples <span class="sc">~</span> model_family <span class="sc">+</span> model) <span class="sc">+</span></span>
<span id="cb140-45"><a href="figures.html#cb140-45" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb140-46"><a href="figures.html#cb140-46" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb140-47"><a href="figures.html#cb140-47" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb140-48"><a href="figures.html#cb140-48" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb140-49"><a href="figures.html#cb140-49" tabindex="-1"></a></span>
<span id="cb140-50"><a href="figures.html#cb140-50" tabindex="-1"></a>p1 <span class="sc">/</span></span>
<span id="cb140-51"><a href="figures.html#cb140-51" tabindex="-1"></a>  p2</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:table-extraction-llm-performance-total-overview-out-of-company"></span>
<img src="_main_files/figure-html/table-extraction-llm-performance-total-overview-out-of-company-1.png" alt="Comparing the overall extraction performance depending on the condition if examples from the same company can be used." width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.18: Comparing the overall extraction performance depending on the condition if examples from the same company can be used.
</p>
</div>
</div>
<div id="openai-models-1" class="section level4 hasAnchor" number="10.2.2.2">
<h4><span class="header-section-number">10.2.2.2</span> OpenAI models<a href="figures.html#openai-models-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="figures.html#cb141-1" tabindex="-1"></a>df_overview_gpt <span class="sc">%&gt;%</span> </span>
<span id="cb141-2"><a href="figures.html#cb141-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb141-3"><a href="figures.html#cb141-3" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> real_table_extraction_regex_total_performance_median, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb141-4"><a href="figures.html#cb141-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> percentage_correct_total, <span class="at">fill =</span> model_family)) <span class="sc">+</span></span>
<span id="cb141-5"><a href="figures.html#cb141-5" tabindex="-1"></a>  <span class="co"># geom_jitter(aes(x = model, y = percentage_correct_total)) +</span></span>
<span id="cb141-6"><a href="figures.html#cb141-6" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb141-7"><a href="figures.html#cb141-7" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family <span class="sc">+</span> n_examples <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb141-8"><a href="figures.html#cb141-8" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb141-9"><a href="figures.html#cb141-9" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb141-10"><a href="figures.html#cb141-10" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:table-extraction-llm-performance-total-gpt"></span>
<img src="_main_files/figure-html/table-extraction-llm-performance-total-gpt-1.png" alt="Comparing the percentage of correct predictions overall for OpenAi's LLMs with some Qwen 3 models" width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.19: Comparing the percentage of correct predictions overall for OpenAi’s LLMs with some Qwen 3 models
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="figures.html#cb142-1" tabindex="-1"></a>df_overview_gpt <span class="sc">%&gt;%</span> </span>
<span id="cb142-2"><a href="figures.html#cb142-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb142-3"><a href="figures.html#cb142-3" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> real_table_extraction_regex_num_performance_median, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb142-4"><a href="figures.html#cb142-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> percentage_correct_numeric, <span class="at">fill =</span> model_family)) <span class="sc">+</span></span>
<span id="cb142-5"><a href="figures.html#cb142-5" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb142-6"><a href="figures.html#cb142-6" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family <span class="sc">+</span> n_examples <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb142-7"><a href="figures.html#cb142-7" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb142-8"><a href="figures.html#cb142-8" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb142-9"><a href="figures.html#cb142-9" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:table-extraction-llm-performance-numeric-gpt"></span>
<img src="_main_files/figure-html/table-extraction-llm-performance-numeric-gpt-1.png" alt="Comparing the percentage of correct numeric predictions for OpenAi's LLMs with some Qwen 3 models" width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.20: Comparing the percentage of correct numeric predictions for OpenAi’s LLMs with some Qwen 3 models
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="figures.html#cb143-1" tabindex="-1"></a>df_overview_gpt <span class="sc">%&gt;%</span> </span>
<span id="cb143-2"><a href="figures.html#cb143-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NA_F1 =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(NA_F1), <span class="dv">0</span>, NA_F1)) <span class="sc">%&gt;%</span> </span>
<span id="cb143-3"><a href="figures.html#cb143-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb143-4"><a href="figures.html#cb143-4" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> real_table_extraction_regex_NA_F1_median, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-5"><a href="figures.html#cb143-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> NA_F1, <span class="at">fill =</span> model_family)) <span class="sc">+</span></span>
<span id="cb143-6"><a href="figures.html#cb143-6" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> df_overview_gpt <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(NA_F1)), <span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> <span class="dv">0</span>), <span class="at">height =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">shape =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb143-7"><a href="figures.html#cb143-7" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb143-8"><a href="figures.html#cb143-8" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family <span class="sc">+</span> n_examples <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb143-9"><a href="figures.html#cb143-9" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb143-10"><a href="figures.html#cb143-10" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb143-11"><a href="figures.html#cb143-11" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:table-extraction-llm-f1-gpt"></span>
<img src="_main_files/figure-html/table-extraction-llm-f1-gpt-1.png" alt="Comparing the F1 score for predicting the missingness of a value for OpenAi's LLMs with some Qwen 3 models. The green crosses indicate results where a model has predicted only numeric values even though there have been missing values." width="100%" height="90%" keepaspectratio />
<p class="caption">
Figure 10.21: Comparing the F1 score for predicting the missingness of a value for OpenAi’s LLMs with some Qwen 3 models. The green crosses indicate results where a model has predicted only numeric values even though there have been missing values.
</p>
</div>
</div>
<div id="hypotheses-5" class="section level4 hasAnchor" number="10.2.2.3">
<h4><span class="header-section-number">10.2.2.3</span> Hypotheses<a href="figures.html#hypotheses-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="figures.html#cb144-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb144-2"><a href="figures.html#cb144-2" tabindex="-1"></a>  real_table_extraction_llm_shap_plot[[i]] <span class="ot">&lt;-</span> real_table_extraction_llm_shap_plot[[i]] <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">tag_level =</span> <span class="st">&#39;new&#39;</span>)</span>
<span id="cb144-3"><a href="figures.html#cb144-3" tabindex="-1"></a>}</span>
<span id="cb144-4"><a href="figures.html#cb144-4" tabindex="-1"></a>  </span>
<span id="cb144-5"><a href="figures.html#cb144-5" tabindex="-1"></a>real_table_extraction_llm_shap_plot <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;1&#39;</span>), <span class="at">tag_sep =</span> <span class="st">&#39;.&#39;</span>) <span class="sc">+</span></span>
<span id="cb144-6"><a href="figures.html#cb144-6" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb144-7"><a href="figures.html#cb144-7" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&#39;The surprising truth about mtcars&#39;</span>,</span>
<span id="cb144-8"><a href="figures.html#cb144-8" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">&#39;These 3 plots will reveal yet-untold secrets about our beloved data-set&#39;</span>,</span>
<span id="cb144-9"><a href="figures.html#cb144-9" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&#39;Disclaimer: None of these plots are insightful&#39;</span></span>
<span id="cb144-10"><a href="figures.html#cb144-10" tabindex="-1"></a>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">22</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:real-table-extraction-llm-shap-plot"></span>
<img src="_main_files/figure-html/real-table-extraction-llm-shap-plot-1.png" alt="Mean absolute SHAP values and beeswarm plots for real table extraction with LLMs" width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.22: Mean absolute SHAP values and beeswarm plots for real table extraction with LLMs
</p>
</div>
</div>
</div>
<div id="synthetic-tables-1" class="section level3 hasAnchor" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Synthetic tables<a href="figures.html#synthetic-tables-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="figures.html#cb145-1" tabindex="-1"></a>df_overview_synth <span class="sc">%&gt;%</span> </span>
<span id="cb145-2"><a href="figures.html#cb145-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb145-3"><a href="figures.html#cb145-3" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> synth_table_extraction_regex_total_performance_median, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb145-4"><a href="figures.html#cb145-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> percentage_correct_total, <span class="at">fill =</span> model_family)) <span class="sc">+</span></span>
<span id="cb145-5"><a href="figures.html#cb145-5" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb145-6"><a href="figures.html#cb145-6" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family <span class="sc">+</span> n_examples <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb145-7"><a href="figures.html#cb145-7" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb145-8"><a href="figures.html#cb145-8" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb145-9"><a href="figures.html#cb145-9" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:synth-table-extraction-llm-performance-total-overview"></span>
<img src="_main_files/figure-html/synth-table-extraction-llm-performance-total-overview-1.png" alt="Percentage of correct extracted or as missing categorized values for table extraction task on synthetic Aktiva tables" width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.23: Percentage of correct extracted or as missing categorized values for table extraction task on synthetic Aktiva tables
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="figures.html#cb146-1" tabindex="-1"></a>df_overview_synth <span class="sc">%&gt;%</span> </span>
<span id="cb146-2"><a href="figures.html#cb146-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb146-3"><a href="figures.html#cb146-3" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> synth_table_extraction_regex_num_performance_median, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb146-4"><a href="figures.html#cb146-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> percentage_correct_numeric, <span class="at">fill =</span> model_family)) <span class="sc">+</span></span>
<span id="cb146-5"><a href="figures.html#cb146-5" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb146-6"><a href="figures.html#cb146-6" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family <span class="sc">+</span> n_examples <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb146-7"><a href="figures.html#cb146-7" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb146-8"><a href="figures.html#cb146-8" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb146-9"><a href="figures.html#cb146-9" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:synth-table-extraction-llm-performance-numeric-overview"></span>
<img src="_main_files/figure-html/synth-table-extraction-llm-performance-numeric-overview-1.png" alt="Percentage of correct extracted numeric values for table extraction task on synthetic Aktiva tables" width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.24: Percentage of correct extracted numeric values for table extraction task on synthetic Aktiva tables
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="figures.html#cb147-1" tabindex="-1"></a>df_overview_synth <span class="sc">%&gt;%</span> </span>
<span id="cb147-2"><a href="figures.html#cb147-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb147-3"><a href="figures.html#cb147-3" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> synth_table_extraction_regex_NA_F1_median, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb147-4"><a href="figures.html#cb147-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> NA_F1, <span class="at">fill =</span> model_family)) <span class="sc">+</span></span>
<span id="cb147-5"><a href="figures.html#cb147-5" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb147-6"><a href="figures.html#cb147-6" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family <span class="sc">+</span> n_examples <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb147-7"><a href="figures.html#cb147-7" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb147-8"><a href="figures.html#cb147-8" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb147-9"><a href="figures.html#cb147-9" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:synth-table-extraction-llm-f1-overview"></span>
<img src="_main_files/figure-html/synth-table-extraction-llm-f1-overview-1.png" alt="F1 score for the missing classification if a value is missing for table extraction task on synthetic Aktiva tables" width="100%" height="95%" keepaspectratio />
<p class="caption">
Figure 10.25: F1 score for the missing classification if a value is missing for table extraction task on synthetic Aktiva tables
</p>
</div>
<div id="confidence-5" class="section level4 hasAnchor" number="10.2.3.1">
<h4><span class="header-section-number">10.2.3.1</span> Confidence<a href="figures.html#confidence-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="figures.html#cb148-1" tabindex="-1"></a>confidence_intervals_synth_by_format <span class="ot">&lt;-</span>  <span class="fu">readRDS</span>(<span class="st">&quot;data_storage/confidence_intervals_synth_by_format.rds&quot;</span>)</span>
<span id="cb148-2"><a href="figures.html#cb148-2" tabindex="-1"></a></span>
<span id="cb148-3"><a href="figures.html#cb148-3" tabindex="-1"></a><span class="co"># confidence_vs_truth_synth &lt;- df_synth_table_extraction %&gt;% </span></span>
<span id="cb148-4"><a href="figures.html#cb148-4" tabindex="-1"></a><span class="co">#   # filter(method_family %in% c(&quot;top_n_rag_examples&quot;, &quot;n_random_examples&quot;)) %&gt;% </span></span>
<span id="cb148-5"><a href="figures.html#cb148-5" tabindex="-1"></a><span class="co">#   filter(model %in% c(&quot;Ministral-8B-Instruct-2410&quot;, &quot;Qwen3-8B&quot;, &quot;Qwen3-235B-A22B-Instruct-2507-FP8&quot;)) %&gt;% </span></span>
<span id="cb148-6"><a href="figures.html#cb148-6" tabindex="-1"></a><span class="co">#   group_by(method, model, loop) %&gt;% mutate(</span></span>
<span id="cb148-7"><a href="figures.html#cb148-7" tabindex="-1"></a><span class="co">#     mean_percentage_correct_total = mean(percentage_correct_total, na.rm=TRUE), .before = 1,</span></span>
<span id="cb148-8"><a href="figures.html#cb148-8" tabindex="-1"></a><span class="co">#     respect_units = !ignore_units</span></span>
<span id="cb148-9"><a href="figures.html#cb148-9" tabindex="-1"></a><span class="co">#   ) %&gt;% group_by(respect_units, model, filepath, input_format) %&gt;% </span></span>
<span id="cb148-10"><a href="figures.html#cb148-10" tabindex="-1"></a><span class="co">#   # arrange(desc(mean_percentage_correct_total)) %&gt;% </span></span>
<span id="cb148-11"><a href="figures.html#cb148-11" tabindex="-1"></a><span class="co">#   slice_max(mean_percentage_correct_total, n = 1, with_ties = FALSE) %&gt;% </span></span>
<span id="cb148-12"><a href="figures.html#cb148-12" tabindex="-1"></a><span class="co">#   mutate(predictions_processed = map(predictions, ~{</span></span>
<span id="cb148-13"><a href="figures.html#cb148-13" tabindex="-1"></a><span class="co">#     .x %&gt;% </span></span>
<span id="cb148-14"><a href="figures.html#cb148-14" tabindex="-1"></a><span class="co">#       select(-&quot;_merge&quot;) %&gt;% </span></span>
<span id="cb148-15"><a href="figures.html#cb148-15" tabindex="-1"></a><span class="co">#       mutate(</span></span>
<span id="cb148-16"><a href="figures.html#cb148-16" tabindex="-1"></a><span class="co">#         match = (year_truth == year_result) | (is.na(year_truth) &amp; is.na(year_result)),</span></span>
<span id="cb148-17"><a href="figures.html#cb148-17" tabindex="-1"></a><span class="co">#         confidence = confidence_this_year,</span></span>
<span id="cb148-18"><a href="figures.html#cb148-18" tabindex="-1"></a><span class="co">#         truth_NA = is.na(year_truth),</span></span>
<span id="cb148-19"><a href="figures.html#cb148-19" tabindex="-1"></a><span class="co">#         predicted_NA = is.na(year_result),</span></span>
<span id="cb148-20"><a href="figures.html#cb148-20" tabindex="-1"></a><span class="co">#         .before = 4</span></span>
<span id="cb148-21"><a href="figures.html#cb148-21" tabindex="-1"></a><span class="co">#       ) %&gt;% nest(</span></span>
<span id="cb148-22"><a href="figures.html#cb148-22" tabindex="-1"></a><span class="co">#         tuple_year = c(match, confidence, truth_NA, predicted_NA)</span></span>
<span id="cb148-23"><a href="figures.html#cb148-23" tabindex="-1"></a><span class="co">#       ) %&gt;% </span></span>
<span id="cb148-24"><a href="figures.html#cb148-24" tabindex="-1"></a><span class="co">#       mutate(</span></span>
<span id="cb148-25"><a href="figures.html#cb148-25" tabindex="-1"></a><span class="co">#         confidence = confidence_previous_year,</span></span>
<span id="cb148-26"><a href="figures.html#cb148-26" tabindex="-1"></a><span class="co">#         match = (previous_year_truth == previous_year_result) | (is.na(previous_year_truth) &amp; is.na(previous_year_result)),</span></span>
<span id="cb148-27"><a href="figures.html#cb148-27" tabindex="-1"></a><span class="co">#         truth_NA = is.na(previous_year_truth),</span></span>
<span id="cb148-28"><a href="figures.html#cb148-28" tabindex="-1"></a><span class="co">#         predicted_NA = is.na(previous_year_result),</span></span>
<span id="cb148-29"><a href="figures.html#cb148-29" tabindex="-1"></a><span class="co">#         .before = 4</span></span>
<span id="cb148-30"><a href="figures.html#cb148-30" tabindex="-1"></a><span class="co">#       ) %&gt;% nest(</span></span>
<span id="cb148-31"><a href="figures.html#cb148-31" tabindex="-1"></a><span class="co">#         tuple_previous_year = c(match, confidence, truth_NA, predicted_NA)</span></span>
<span id="cb148-32"><a href="figures.html#cb148-32" tabindex="-1"></a><span class="co">#       ) %&gt;% select(</span></span>
<span id="cb148-33"><a href="figures.html#cb148-33" tabindex="-1"></a><span class="co">#         -c(year_truth, previous_year_truth, year_result, previous_year_result,</span></span>
<span id="cb148-34"><a href="figures.html#cb148-34" tabindex="-1"></a><span class="co">#            confidence_this_year, confidence_previous_year)</span></span>
<span id="cb148-35"><a href="figures.html#cb148-35" tabindex="-1"></a><span class="co">#       ) %&gt;% </span></span>
<span id="cb148-36"><a href="figures.html#cb148-36" tabindex="-1"></a><span class="co">#       pivot_longer(-c(&quot;E1&quot;, &quot;E2&quot;, &quot;E3&quot;)) %&gt;% </span></span>
<span id="cb148-37"><a href="figures.html#cb148-37" tabindex="-1"></a><span class="co">#       unnest(cols = value) %&gt;% mutate(</span></span>
<span id="cb148-38"><a href="figures.html#cb148-38" tabindex="-1"></a><span class="co">#         match = if_else(is.na(match), FALSE, match)</span></span>
<span id="cb148-39"><a href="figures.html#cb148-39" tabindex="-1"></a><span class="co">#       )</span></span>
<span id="cb148-40"><a href="figures.html#cb148-40" tabindex="-1"></a><span class="co">#   })) %&gt;% </span></span>
<span id="cb148-41"><a href="figures.html#cb148-41" tabindex="-1"></a><span class="co">#   unnest(predictions_processed) %&gt;% mutate(</span></span>
<span id="cb148-42"><a href="figures.html#cb148-42" tabindex="-1"></a><span class="co">#     match = factor(match, levels = c(F, T)),</span></span>
<span id="cb148-43"><a href="figures.html#cb148-43" tabindex="-1"></a><span class="co">#     truth_NA = factor(truth_NA, levels = c(F, T))</span></span>
<span id="cb148-44"><a href="figures.html#cb148-44" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb148-45"><a href="figures.html#cb148-45" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-46"><a href="figures.html#cb148-46" tabindex="-1"></a><span class="co"># confidence_intervals_synth &lt;- confidence_vs_truth_synth %&gt;% #rename(confidence = confidence_score) %&gt;% </span></span>
<span id="cb148-47"><a href="figures.html#cb148-47" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb148-48"><a href="figures.html#cb148-48" tabindex="-1"></a><span class="co">#     conf_interval = cut(confidence, breaks = seq(0, 1, by = 0.05), include.lowest = TRUE),</span></span>
<span id="cb148-49"><a href="figures.html#cb148-49" tabindex="-1"></a><span class="co">#     conf_center = as.numeric(sub(&quot;\\((.+),(.+)\\]&quot;, &quot;\\1&quot;, levels(conf_interval))[conf_interval]) + 0.025</span></span>
<span id="cb148-50"><a href="figures.html#cb148-50" tabindex="-1"></a><span class="co">#   ) %&gt;%</span></span>
<span id="cb148-51"><a href="figures.html#cb148-51" tabindex="-1"></a><span class="co">#   group_by(conf_center, predicted_NA, model, respect_units, input_format) %&gt;%</span></span>
<span id="cb148-52"><a href="figures.html#cb148-52" tabindex="-1"></a><span class="co">#   summarise(</span></span>
<span id="cb148-53"><a href="figures.html#cb148-53" tabindex="-1"></a><span class="co">#     n_true = sum(match == TRUE, na.rm = TRUE),</span></span>
<span id="cb148-54"><a href="figures.html#cb148-54" tabindex="-1"></a><span class="co">#     n_false = sum(match == FALSE, na.rm = TRUE),</span></span>
<span id="cb148-55"><a href="figures.html#cb148-55" tabindex="-1"></a><span class="co">#     total = n_true + n_false,</span></span>
<span id="cb148-56"><a href="figures.html#cb148-56" tabindex="-1"></a><span class="co">#     chance_false = if_else(total &gt; 0, n_false / total * 100, NA_real_),</span></span>
<span id="cb148-57"><a href="figures.html#cb148-57" tabindex="-1"></a><span class="co">#     chance_zero = chance_false == 0,</span></span>
<span id="cb148-58"><a href="figures.html#cb148-58" tabindex="-1"></a><span class="co">#     chance_below_1 = chance_false &lt; 1,</span></span>
<span id="cb148-59"><a href="figures.html#cb148-59" tabindex="-1"></a><span class="co">#     chance_low = if_else(chance_zero, 0, if_else(chance_below_1, 1, 2)),</span></span>
<span id="cb148-60"><a href="figures.html#cb148-60" tabindex="-1"></a><span class="co">#     chance_low = factor(chance_low, levels = c(0,1,2), labels = c(&quot;equls 0 %&quot;, &quot;below 1 %&quot;, &quot;more&quot;))</span></span>
<span id="cb148-61"><a href="figures.html#cb148-61" tabindex="-1"></a><span class="co">#   ) %&gt;% group_by(predicted_NA, model, respect_units) %&gt;% mutate(</span></span>
<span id="cb148-62"><a href="figures.html#cb148-62" tabindex="-1"></a><span class="co">#     perc = total/sum(total)*100</span></span>
<span id="cb148-63"><a href="figures.html#cb148-63" tabindex="-1"></a><span class="co">#   ) %&gt;% ungroup() %&gt;% </span></span>
<span id="cb148-64"><a href="figures.html#cb148-64" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb148-65"><a href="figures.html#cb148-65" tabindex="-1"></a><span class="co">#     chance_false_interval = cut(</span></span>
<span id="cb148-66"><a href="figures.html#cb148-66" tabindex="-1"></a><span class="co">#       chance_false,</span></span>
<span id="cb148-67"><a href="figures.html#cb148-67" tabindex="-1"></a><span class="co">#       breaks = c(0, 1, 2, 4, 8, 16, 32, 64, Inf),</span></span>
<span id="cb148-68"><a href="figures.html#cb148-68" tabindex="-1"></a><span class="co">#       labels = c(&quot;[0,1)&quot;, &quot;[1,2)&quot;, &quot;[2,4)&quot;, &quot;[4,8)&quot;, </span></span>
<span id="cb148-69"><a href="figures.html#cb148-69" tabindex="-1"></a><span class="co">#                  &quot;[8,16)&quot;, &quot;[16,32)&quot;, &quot;[32,64)&quot;, &quot;[64,Inf)&quot;),</span></span>
<span id="cb148-70"><a href="figures.html#cb148-70" tabindex="-1"></a><span class="co">#       right = FALSE,</span></span>
<span id="cb148-71"><a href="figures.html#cb148-71" tabindex="-1"></a><span class="co">#       ordered_result = TRUE</span></span>
<span id="cb148-72"><a href="figures.html#cb148-72" tabindex="-1"></a><span class="co">#     ),</span></span>
<span id="cb148-73"><a href="figures.html#cb148-73" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb148-74"><a href="figures.html#cb148-74" tabindex="-1"></a></span>
<span id="cb148-75"><a href="figures.html#cb148-75" tabindex="-1"></a>confidence_intervals_synth_by_format <span class="sc">%&gt;%</span></span>
<span id="cb148-76"><a href="figures.html#cb148-76" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb148-77"><a href="figures.html#cb148-77" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(</span>
<span id="cb148-78"><a href="figures.html#cb148-78" tabindex="-1"></a>    <span class="at">x =</span> conf_center, <span class="at">y =</span> perc, </span>
<span id="cb148-79"><a href="figures.html#cb148-79" tabindex="-1"></a>    <span class="at">color =</span> chance_low, </span>
<span id="cb148-80"><a href="figures.html#cb148-80" tabindex="-1"></a>    <span class="at">fill =</span> chance_false_interval</span>
<span id="cb148-81"><a href="figures.html#cb148-81" tabindex="-1"></a>  ), <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb148-82"><a href="figures.html#cb148-82" tabindex="-1"></a>  <span class="co"># geom_text(</span></span>
<span id="cb148-83"><a href="figures.html#cb148-83" tabindex="-1"></a>  <span class="co">#   aes(x = conf_center, y = perc, label = round(perc, 0)), </span></span>
<span id="cb148-84"><a href="figures.html#cb148-84" tabindex="-1"></a>  <span class="co">#   position = position_stack(vjust = 1), vjust = -0.6, </span></span>
<span id="cb148-85"><a href="figures.html#cb148-85" tabindex="-1"></a>  <span class="co">#   size = 3, color = &quot;black&quot;</span></span>
<span id="cb148-86"><a href="figures.html#cb148-86" tabindex="-1"></a>  <span class="co"># ) +</span></span>
<span id="cb148-87"><a href="figures.html#cb148-87" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;equls 0 %&quot;</span> <span class="ot">=</span> <span class="st">&quot;#00CC00&quot;</span>, <span class="st">&quot;below 1 %&quot;</span> <span class="ot">=</span> <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;more&quot;</span> <span class="ot">=</span> <span class="st">&quot;#555555&quot;</span>)) <span class="sc">+</span></span>
<span id="cb148-88"><a href="figures.html#cb148-88" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">&quot;#d53e4f&quot;</span>, <span class="st">&quot;#f46d43&quot;</span>, <span class="st">&quot;#fdae61&quot;</span>, <span class="st">&quot;#fee08b&quot;</span>, <span class="st">&quot;#e6f598&quot;</span>, <span class="st">&quot;#abdda4&quot;</span>, <span class="st">&quot;#66c2a5&quot;</span>, <span class="st">&quot;#3288bd&quot;</span>)), <span class="at">drop =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb148-89"><a href="figures.html#cb148-89" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb148-90"><a href="figures.html#cb148-90" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Confidence Interval Center&quot;</span>, </span>
<span id="cb148-91"><a href="figures.html#cb148-91" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Percentage of predictions&quot;</span>, </span>
<span id="cb148-92"><a href="figures.html#cb148-92" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;mistake rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb148-93"><a href="figures.html#cb148-93" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(</span>
<span id="cb148-94"><a href="figures.html#cb148-94" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb148-95"><a href="figures.html#cb148-95" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb148-96"><a href="figures.html#cb148-96" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb148-97"><a href="figures.html#cb148-97" tabindex="-1"></a>  <span class="fu">facet_nested</span>(<span class="fu">paste</span>(<span class="st">&quot;respect units:&quot;</span>, respect_units)<span class="sc">+</span><span class="fu">paste</span>(<span class="st">&quot;predicted NA:&quot;</span>, predicted_NA) <span class="sc">~</span> model<span class="sc">+</span>input_format)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:table-extraction-llm-confidence-lm-synth-grouped-by-input-format"></span>
<img src="_main_files/figure-html/table-extraction-llm-confidence-lm-synth-grouped-by-input-format-1.png" alt="Estimating the relative frequency to find a wrong extraction result over different confidence intervals for predictions for the synthetic table extraction task. Additionally grouped by input format." width="100%" />
<p class="caption">
Figure 10.26: Estimating the relative frequency to find a wrong extraction result over different confidence intervals for predictions for the synthetic table extraction task. Additionally grouped by input format.
</p>
</div>
</div>
</div>
<div id="hybrid-approach-1" class="section level3 hasAnchor" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Hybrid approach<a href="figures.html#hybrid-approach-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="figures.html#cb149-1" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb149-2"><a href="figures.html#cb149-2" tabindex="-1"></a>  df_real_table_extraction_synth <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">context =</span> <span class="st">&quot;synth&quot;</span>), </span>
<span id="cb149-3"><a href="figures.html#cb149-3" tabindex="-1"></a>  df_real_table_extraction <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">context =</span> <span class="st">&quot;real&quot;</span>)</span>
<span id="cb149-4"><a href="figures.html#cb149-4" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb149-5"><a href="figures.html#cb149-5" tabindex="-1"></a>  <span class="fu">filter</span>(model <span class="sc">%in%</span> best_models_with_examples<span class="sc">$</span>model) <span class="sc">%&gt;%</span> </span>
<span id="cb149-6"><a href="figures.html#cb149-6" tabindex="-1"></a>  <span class="fu">filter</span>(method_family <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;top_n_rag_examples&quot;</span>, <span class="st">&quot;n_random_examples&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb149-7"><a href="figures.html#cb149-7" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb149-8"><a href="figures.html#cb149-8" tabindex="-1"></a>    <span class="co"># model = factor(model, levels = model_by_size),</span></span>
<span id="cb149-9"><a href="figures.html#cb149-9" tabindex="-1"></a>    <span class="at">method_family =</span> <span class="fu">factor</span>(method_family, <span class="at">levels =</span> method_order),</span>
<span id="cb149-10"><a href="figures.html#cb149-10" tabindex="-1"></a>    <span class="at">n_examples =</span> <span class="fu">fct_rev</span>(<span class="fu">ordered</span>(<span class="fu">paste</span>(<span class="st">&quot;n =&quot;</span>, n_examples)))</span>
<span id="cb149-11"><a href="figures.html#cb149-11" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb149-12"><a href="figures.html#cb149-12" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb149-13"><a href="figures.html#cb149-13" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>context, <span class="at">y =</span> percentage_correct_total), <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb149-14"><a href="figures.html#cb149-14" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c(&quot;blue&quot;, &quot;orange&quot;)) +</span></span>
<span id="cb149-15"><a href="figures.html#cb149-15" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb149-16"><a href="figures.html#cb149-16" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family<span class="sc">+</span>n_examples<span class="sc">~</span>model)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:compare-real-table-extraction-by-context-type"></span>
<img src="_main_files/figure-html/compare-real-table-extraction-by-context-type-1.png" alt="Comparing table extraction perfromance for real Aktiva extraction task with synthetic and real examples for in-context learning" width="100%" />
<p class="caption">
Figure 10.27: Comparing table extraction perfromance for real Aktiva extraction task with synthetic and real examples for in-context learning
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="figures.html#cb150-1" tabindex="-1"></a>df_real_table_extraction_synth_respect_units <span class="sc">%&gt;%</span> </span>
<span id="cb150-2"><a href="figures.html#cb150-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb150-3"><a href="figures.html#cb150-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">fill=</span>respect_units, <span class="at">y =</span> percentage_correct_total), <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb150-4"><a href="figures.html#cb150-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb150-5"><a href="figures.html#cb150-5" tabindex="-1"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n_col_T_EUR <span class="sc">&gt;</span> <span class="dv">0</span>), </span>
<span id="cb150-6"><a href="figures.html#cb150-6" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">group=</span>respect_units, <span class="at">color =</span> <span class="fu">factor</span>(n_col_T_EUR), <span class="at">y =</span> percentage_correct_total), </span>
<span id="cb150-7"><a href="figures.html#cb150-7" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">width =</span> <span class="fl">0.3</span></span>
<span id="cb150-8"><a href="figures.html#cb150-8" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb150-9"><a href="figures.html#cb150-9" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb150-10"><a href="figures.html#cb150-10" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb150-11"><a href="figures.html#cb150-11" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family<span class="sc">+</span>n_examples<span class="sc">~</span>model<span class="sc">+</span>respect_units) <span class="sc">+</span></span>
<span id="cb150-12"><a href="figures.html#cb150-12" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb150-13"><a href="figures.html#cb150-13" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb150-14"><a href="figures.html#cb150-14" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:compare-effect-of-respecting-units-on-overall-performance"></span>
<img src="_main_files/figure-html/compare-effect-of-respecting-units-on-overall-performance-1.png" alt="Comparing the effect on overall perfrormance if currency units should be respected on all predictions and specifically on predictions where all or just some columns have units." width="100%" />
<p class="caption">
Figure 10.28: Comparing the effect on overall perfrormance if currency units should be respected on all predictions and specifically on predictions where all or just some columns have units.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="figures.html#cb151-1" tabindex="-1"></a>df_real_table_extraction_synth_respect_units <span class="sc">%&gt;%</span> </span>
<span id="cb151-2"><a href="figures.html#cb151-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb151-3"><a href="figures.html#cb151-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">fill=</span>respect_units, <span class="at">y =</span> percentage_correct_numeric), <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb151-4"><a href="figures.html#cb151-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb151-5"><a href="figures.html#cb151-5" tabindex="-1"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n_col_T_EUR <span class="sc">&gt;</span> <span class="dv">0</span>), </span>
<span id="cb151-6"><a href="figures.html#cb151-6" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">group=</span>respect_units, <span class="at">color =</span> <span class="fu">factor</span>(n_col_T_EUR), <span class="at">y =</span> percentage_correct_numeric), </span>
<span id="cb151-7"><a href="figures.html#cb151-7" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">width =</span> <span class="fl">0.3</span></span>
<span id="cb151-8"><a href="figures.html#cb151-8" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb151-9"><a href="figures.html#cb151-9" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb151-10"><a href="figures.html#cb151-10" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb151-11"><a href="figures.html#cb151-11" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family<span class="sc">+</span>n_examples<span class="sc">~</span>model<span class="sc">+</span>respect_units) <span class="sc">+</span></span>
<span id="cb151-12"><a href="figures.html#cb151-12" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb151-13"><a href="figures.html#cb151-13" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb151-14"><a href="figures.html#cb151-14" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:compare-effect-of-respecting-units-on-numeric-performance"></span>
<img src="_main_files/figure-html/compare-effect-of-respecting-units-on-numeric-performance-1.png" alt="Comparing the effect on numeric perfrormance if currency units should be respected on all predictions and specifically on predictions where all or just some columns have units." width="100%" />
<p class="caption">
Figure 10.29: Comparing the effect on numeric perfrormance if currency units should be respected on all predictions and specifically on predictions where all or just some columns have units.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="figures.html#cb152-1" tabindex="-1"></a>df_real_table_extraction_synth_respect_units <span class="sc">%&gt;%</span> </span>
<span id="cb152-2"><a href="figures.html#cb152-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb152-3"><a href="figures.html#cb152-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">fill=</span>respect_units, <span class="at">y =</span> NA_F1), <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb152-4"><a href="figures.html#cb152-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb152-5"><a href="figures.html#cb152-5" tabindex="-1"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n_col_T_EUR <span class="sc">&gt;</span> <span class="dv">0</span>), </span>
<span id="cb152-6"><a href="figures.html#cb152-6" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">group=</span>respect_units, <span class="at">color =</span> <span class="fu">factor</span>(n_col_T_EUR), <span class="at">y =</span> NA_F1), </span>
<span id="cb152-7"><a href="figures.html#cb152-7" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">width =</span> <span class="fl">0.3</span></span>
<span id="cb152-8"><a href="figures.html#cb152-8" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb152-9"><a href="figures.html#cb152-9" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb152-10"><a href="figures.html#cb152-10" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb152-11"><a href="figures.html#cb152-11" tabindex="-1"></a>  <span class="fu">facet_nested</span>(method_family<span class="sc">+</span>n_examples<span class="sc">~</span>model<span class="sc">+</span>respect_units) <span class="sc">+</span></span>
<span id="cb152-12"><a href="figures.html#cb152-12" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb152-13"><a href="figures.html#cb152-13" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb152-14"><a href="figures.html#cb152-14" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:compare-effect-of-respecting-units-on-NA-F1"></span>
<img src="_main_files/figure-html/compare-effect-of-respecting-units-on-NA-F1-1.png" alt="Comparing the effect on NA F1 score if currency units should be respected on all predictions and specifically on predictions where all or just some columns have units." width="100%" />
<p class="caption">
Figure 10.30: Comparing the effect on NA F1 score if currency units should be respected on all predictions and specifically on predictions where all or just some columns have units.
</p>
</div>
<p>real_table_extraction_llm_synth_context_shap_plot</p>
</div>
</div>
</div>
<script>
// Lightbox functionality for displaying images in a modal view
document.addEventListener("DOMContentLoaded", function () {
  // Create a lightbox container
  const lightbox = document.createElement("div");
  lightbox.id = "lightbox";
  lightbox.style.position = "fixed";
  lightbox.style.top = "0";
  lightbox.style.left = "0";
  lightbox.style.width = "100%";
  lightbox.style.height = "100%";
  lightbox.style.backgroundColor = "rgba(0, 0, 0, 0.8)";
  lightbox.style.display = "none";
  lightbox.style.justifyContent = "center";
  lightbox.style.alignItems = "center";
  lightbox.style.zIndex = "1000";
  document.body.appendChild(lightbox);

  // Add an image element to the lightbox
  const lightboxImage = document.createElement("img");
  lightboxImage.id = "lightbox-image";
  // lightboxImage.style.maxWidth = "90%";
  // lightboxImage.style.maxHeight = "90%";
  lightbox.appendChild(lightboxImage);

  // Close lightbox on click
  lightbox.addEventListener("click", function () {
    lightbox.style.display = "none";
  });

  // Add onclick event to all images except the excluded one
  const images = document.querySelectorAll("img");
  images.forEach((img) => {
    if (img.src.includes("images/BHT_Logo_horizontal_Anthrazit_transparent.svg")) {
      return; // Skip the excluded image
    }
    img.style.cursor = "pointer"; // Change cursor to indicate clickability
    img.addEventListener("click", function () {
      lightboxImage.src = img.src; // Set the lightbox image source
      lightbox.style.display = "flex"; // Show the lightbox
    });
  });
});
</script>

<script>
// Image slider/carousel functionality for divs with class "image-slider"
document.addEventListener("DOMContentLoaded", function () {
  document.querySelectorAll('.image-slider').forEach(function (slider) {
    const images = slider.querySelectorAll('img');
    if (images.length < 2) return; // No need for slider if only one image

    // Hide all images except the first
    images.forEach((img, i) => img.style.display = i === 0 ? 'inline' : 'none');
    let current = 0;

    // Create navigation buttons
    const prevBtn = document.createElement('button');
    prevBtn.textContent = '⟨ Prev';
    prevBtn.style.marginRight = '10px';
    const nextBtn = document.createElement('button');
    nextBtn.textContent = 'Next ⟩';
    nextBtn.style.marginLeft = '10px';

    // Create a caption container
    const captionContainer = document.createElement('div');
    captionContainer.style.fontStyle = 'italic';
    captionContainer.style.color = '#555';

    // Create a flex container for buttons and caption
    const controlsContainer = document.createElement('div');
    controlsContainer.style.display = 'flex';
    controlsContainer.style.justifyContent = 'space-between';
    controlsContainer.style.alignItems = 'center';
    controlsContainer.style.marginTop = '10px';
    controlsContainer.style.width = '100%';

    // Place buttons and caption in flex container
    controlsContainer.appendChild(prevBtn);
    controlsContainer.appendChild(captionContainer);
    controlsContainer.appendChild(nextBtn);

    // Function to update the caption
    const updateCaption = () => {
      const caption = images[current].nextElementSibling;
      if (caption && caption.classList.contains('image-caption')) {
        captionContainer.textContent = caption.textContent;
      } else {
        captionContainer.textContent = ''; // Clear caption if none exists
      }
    };

    // Function to show the next image
    const showNextImage = () => {
      images[current].style.display = 'none';
      current = (current + 1) % images.length;
      images[current].style.display = 'inline';
      updateCaption();
    };

    // Function to show the previous image
    const showPrevImage = () => {
      images[current].style.display = 'none';
      current = (current - 1 + images.length) % images.length;
      images[current].style.display = 'inline';
      updateCaption();
    };

    // Button click handlers
    prevBtn.onclick = function () {
      stopAutoSlide();
      showPrevImage();
    };
    nextBtn.onclick = function () {
      stopAutoSlide();
      showNextImage();
    };

    // Insert controls container below images
    slider.appendChild(controlsContainer);

    // Automatic sliding
    let autoSlideInterval = setInterval(showNextImage, 2000);

    // Stop automatic sliding on user interaction
    const stopAutoSlide = () => {
      clearInterval(autoSlideInterval);
    };

    // Stop auto-slide when the user interacts with the slider
    prevBtn.addEventListener('click', stopAutoSlide);
    nextBtn.addEventListener('click', stopAutoSlide);
    images.forEach((img) => {
      img.addEventListener('click', stopAutoSlide);
    });

    // Initialize the caption
    updateCaption();
  });
});
</script>

<script>
// Dropdown filter functionality for images with lightbox
document.addEventListener("DOMContentLoaded", function () {
  document.querySelectorAll('.image-selector').forEach(function (selector) {
    const images = selector.querySelectorAll('img');
    if (images.length === 0) return;

    // Create a dropdown filter container
    const filterContainer = document.createElement('div');
    filterContainer.classList.add('filter-container');

    const dropdown = document.createElement('select');
    dropdown.multiple = true;
    dropdown.classList.add('filter-dropdown');

    // Add options to the dropdown
    const uniqueCategories = [];
    images.forEach((img) => {
      const caption = img.nextElementSibling;
      if (caption && caption.classList.contains('image-caption')) {
        const category = caption.textContent.trim();
        if (!uniqueCategories.includes(category)) uniqueCategories.push(category);
      }
    });

    uniqueCategories.forEach((category) => {
      const option = document.createElement('option');
      option.value = category;
      option.textContent = category;
      // Do NOT set option.selected here!
      dropdown.appendChild(option);
    });

    filterContainer.appendChild(dropdown);
    selector.appendChild(filterContainer);

    // Add a grid container for filtered images
    const gridContainer = document.createElement('div');
    gridContainer.classList.add('image-grid');
    selector.appendChild(gridContainer);

    // Choices.js initialization
    const choices = new Choices(dropdown, {
      removeItemButton: true,
      shouldSort: false,
      searchEnabled: false,
      placeholder: true,
      placeholderValue: 'Filter categories',
    });

    // Clear any existing selection first, then set initial selection
    choices.removeActiveItems(); // This clears existing selections
    choices.setChoiceByValue(uniqueCategories[0]); // This sets only the first category

    // Filtering function
    const filterImages = () => {
      const selectedCategories = Array.from(dropdown.selectedOptions).map(opt => opt.value);
      gridContainer.innerHTML = '';
      let shownWrappers = [];
      images.forEach((img) => {
        const caption = img.nextElementSibling;
        if (caption && caption.classList.contains('image-caption')) {
          const category = caption.textContent.trim();
          if (selectedCategories.includes(category)) {
            const imgWrapper = document.createElement('div');
            imgWrapper.classList.add('image-wrapper');
            const imgClone = img.cloneNode(true);
            imgClone.style.cursor = 'pointer';
            imgClone.addEventListener('click', function () {
              const lightboxImage = document.querySelector("#lightbox img");
              const lightbox = document.querySelector("#lightbox");
              lightboxImage.src = imgClone.src;
              lightbox.style.display = 'flex';
            });
            imgWrapper.appendChild(imgClone);
            const captionClone = caption.cloneNode(true);
            imgWrapper.appendChild(captionClone);
            gridContainer.appendChild(imgWrapper);
            shownWrappers.push(imgWrapper);
          }
        }
      });
      // If only one image is shown, make it span both columns
      if (shownWrappers.length === 1) {
        shownWrappers[0].style.gridColumn = "span 2";
      }
    };

    // Listen for changes from Choices.js
    dropdown.addEventListener('change', filterImages);

    // Initial grid (only first category shown)
    filterImages();
  });
});
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  var codes = document.querySelectorAll('.hideme');
  var code, i, d, s, p;
  for (i = 0; i < codes.length; i++) {
    code = codes[i];
    p = code.parentNode;
    d = document.createElement('details');
    s = document.createElement('summary');
    s.innerText = 'Details';
    // <details><summary>Details</summary></details>
    d.appendChild(s);
    // move the code into <details>
    p.replaceChild(d, code);
    d.appendChild(code);
  }
});
</script>
            </section>

          </div>
        </div>
      </div>
<a href="tables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="layout-testing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["_main.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
