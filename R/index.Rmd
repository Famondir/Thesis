---
title: "Extraction of tabular data from annual reports with LLMs"
author: "Simon SchÃ¤fer"
date: "September 8, 2025"
site: "bookdown::bookdown_site"
# Change this to FALSE if you'd like to install them manually on your own.
# params:
#   'Install needed packages for {thesisdown}': True

output:
  # bookdown::pdf_book:
  bookdown::pdf_document2:
    # latex_engine: xelatex
    pandoc_args: 
      # - --lua-filter=report_misc/acrfull.lua
      - !expr acronymsdown::add_filter()
    toc: false
    lof: yes 
    lot: yes
    includes:
      in_header:
        - report_misc/bhtThesis.sty
        - report_misc/preamble.tex
  bookdown::gitbook:
    pandoc_args: 
      # - --lua-filter=report_misc/acrfull.lua
      - !expr acronymsdown::add_filter()
    code_folding: hide
    toc_depth: 4
    config:
      toc:
        before: |
          <li class="toc-logo"><a href="./"><img src="images/BHT_Logo_horizontal_Anthrazit_transparent.svg"></a></li>
    includes:
      in_header:
        - report_misc/head.html
      after_body: 
        - report_misc/image_effects.html
        - report_misc/code_folding.html
css: "report_misc/style.css"
documentclass: book
bibliography: ["report_misc/DS 4th: Extracting financial data from annual reports.bib"]
biblio-style: apa
link-citations: yes
csl: report_misc/apa-single-spaced.csl
acronyms:
  fromfile: ./report_misc/acronyms.yml
  loa_title: ""
  insert_loa: false
  insert_links: true
  # sorting: usage
  include_unused: true
  style: short-long
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(kableExtra.latex.load_packages = FALSE)
# knitr::opts_chunk$set(fig.pos = "H", out.extra = "")

library(jsonlite)
library(tidyverse)
library(reticulate)
use_python("~/anaconda3/envs/llm/bin/python")

library(knitr)
library(kableExtra)
library(DT) # For interactive HTML tables

library(shapviz)
library(h2o)

library(stringr)
library(readr)
library(xml2)
library(knitr)

library(ggplot2)
library(patchwork)
library(ggh4x)
library(PRROC)
```

```{r load_layout_functions, include=FALSE}
source("report_misc/layout_functions.R")
source("report_misc/helper_functions.R")

echo_flag <- knitr::is_html_output() ? NA : FALSE
message_flag = FALSE
warning_flag = FALSE
cache_large_figures = TRUE
```

\pagenumbering{gobble}
\pagestyle{empty}

# {.unlisted .unnumbered}

## Abstract {.unlisted .unnumbered}

Content of this thesis is a benchmark on information extraction from PDFs. The focus are annual reports of German companies. Special characteristic of the task is handling hierarchies in tables with financial data to prepare the data for import into a relational database.

The benchmark is composed of three sub tasks and the performance of different open source large language models is tested with different prompting approaches and compared to alternative methods.

This can be seen as a reimplementation study of "Extracting Financial Data from Unstructured Sources: Leveraging Large Language Models" - a paper published by @li_extracting_2023. The key differences are the application on German documents using open source large language models.

## Zusammenfassung {.unlisted .unnumbered}

Gegenstand dieser Arbeit ist ein Benchmark zur Informationsextraktion aus PDF-Dateien. Dabei wird sich auf das Auslesen der Bilanzen und Gewinn- und Verlustrechnungen aus JahresabschlÃ¼ssen deutscher Unternehmen beschrÃ¤nkt. Ein besonderer Aspekt der Aufgabe ist die BerÃ¼cksichtigung der Hierarchie innerhalb der Tabellen, um die Werte einem festen Schema zuzuordnen und so den Import in eine relationale Datenbank vorzubereiten.

## Reading advices {.unlisted .unnumbered}

The author recommends to read the thesis in its digital gitbook version instead of the PDF version. Furthermore, the author recommends to read the thesis (any version) on a screen that is larger than 21" and has at least full HD resolution^[Most of the time the thesis was inspected at a third of the authors 42" screen with 4k resolution. For inspecting the large overview graphics it is a very handy tool the author recommends every data scientist or software developer.]. The more, the merrier.

\huge <span style="font-size: 1.5em;">ðŸ˜Š</span> \normalsize

## Goals and Learnings {.unlisted .unnumbered}

Achieved:

* thesis with bookdown
* docker image creation
* cluster orchestration
* llm usage
* guided decoding

Missed:

* Administrating a k8s cluster
* Fine tuning a model
* using small language models
* training a lm
* using vllms

\pagestyle{fancy}

\cleardoublepage
\pagenumbering{roman}
\setcounter{page}{1}
\tableofcontents

\cleardoublepage
\pagenumbering{arabic}
\setcounter{page}{1}